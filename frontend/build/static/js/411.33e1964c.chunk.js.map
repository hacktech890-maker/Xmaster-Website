{"version":3,"file":"static/js/411.33e1964c.chunk.js","mappings":"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","sources":["pages/public/WatchPage.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useParams, Link } from \"react-router-dom\";\nimport {\n  FiEye,\n  FiCalendar,\n  FiClock,\n  FiThumbsUp,\n  FiThumbsDown,\n  FiShare2,\n  FiFlag,\n  FiChevronDown,\n  FiChevronUp,\n} from \"react-icons/fi\";\nimport { publicAPI } from \"../../services/api\";\nimport LoadingSpinner from \"../../components/common/LoadingSpinner\";\n\n// Placeholder image\nconst PLACEHOLDER =\n  \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIwIiBoZWlnaHQ9IjE4MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMWUxZTFlIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNiIgZmlsbD0iIzY2NiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIFRodW1ibmFpbDwvdGV4dD48L3N2Zz4=\";\n\nconst formatViews = (views) => {\n  if (!views) return \"0\";\n  if (views >= 1000000) return (views / 1000000).toFixed(1).replace(/\\.0$/, \"\") + \"M\";\n  if (views >= 1000) return (views / 1000).toFixed(1).replace(/\\.0$/, \"\") + \"K\";\n  return views.toString();\n};\n\nconst formatDate = (date) => {\n  if (!date) return \"Unknown\";\n  const d = new Date(date);\n  if (isNaN(d.getTime())) return \"Unknown\";\n  return d.toLocaleDateString(\"en-US\", { year: \"numeric\", month: \"short\", day: \"numeric\" });\n};\n\nconst formatRelativeDate = (date) => {\n  if (!date) return \"\";\n  const now = new Date();\n  const past = new Date(date);\n  if (isNaN(past.getTime())) return \"\";\n  const diff = Math.floor((now - past) / 1000);\n  if (diff < 60) return \"Just now\";\n  if (diff < 3600) return `${Math.floor(diff / 60)}m ago`;\n  if (diff < 86400) return `${Math.floor(diff / 3600)}h ago`;\n  if (diff < 604800) return `${Math.floor(diff / 86400)}d ago`;\n  if (diff < 2592000) return `${Math.floor(diff / 604800)}w ago`;\n  return formatDate(date);\n};\n\nfunction WatchPage() {\n  const { id } = useParams();\n  const [video, setVideo] = useState(null);\n  const [relatedVideos, setRelatedVideos] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [descExpanded, setDescExpanded] = useState(false);\n  const [likes, setLikes] = useState(0);\n  const [dislikes, setDislikes] = useState(0);\n  const [liked, setLiked] = useState(false);\n  const [disliked, setDisliked] = useState(false);\n  const [showReport, setShowReport] = useState(false);\n  const [reportReason, setReportReason] = useState(\"\");\n\n  // Fetch video + related\n  useEffect(() => {\n    const fetchData = async () => {\n      setLoading(true);\n      setError(null);\n\n      try {\n        // Fetch video\n        const response = await publicAPI.getVideo(id);\n        const videoData = response.data?.video || response.data?.data || response.data;\n        setVideo(videoData);\n        setLikes(videoData.likes || 0);\n        setDislikes(videoData.dislikes || 0);\n\n        // Record view\n        try {\n          await publicAPI.recordView(id);\n        } catch (e) {\n          // Silent fail for view count\n        }\n\n        // Fetch related videos\n        try {\n          const relatedRes = await publicAPI.getRelatedVideos(id, 12);\n          if (relatedRes.data?.success) {\n            setRelatedVideos(relatedRes.data.videos || []);\n          }\n        } catch (e) {\n          // Try fallback - get latest videos\n          try {\n            const latestRes = await publicAPI.getLatestVideos(12);\n            if (latestRes.data?.success) {\n              // Filter out current video\n              const filtered = (latestRes.data.videos || []).filter((v) => v._id !== id);\n              setRelatedVideos(filtered);\n            }\n          } catch (e2) {\n            console.error(\"Failed to fetch any recommendations:\", e2);\n          }\n        }\n      } catch (err) {\n        setError(\"Failed to load video\");\n        console.error(err);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchData();\n    // Scroll to top on video change\n    window.scrollTo({ top: 0, behavior: \"smooth\" });\n  }, [id]);\n\n  // Handle like\n  const handleLike = async () => {\n    if (liked) return;\n    try {\n      await publicAPI.likeVideo(id);\n      setLikes((prev) => prev + 1);\n      setLiked(true);\n      if (disliked) {\n        setDislikes((prev) => prev - 1);\n        setDisliked(false);\n      }\n    } catch (e) {\n      console.error(\"Like failed:\", e);\n    }\n  };\n\n  // Handle dislike\n  const handleDislike = async () => {\n    if (disliked) return;\n    try {\n      await publicAPI.dislikeVideo(id);\n      setDislikes((prev) => prev + 1);\n      setDisliked(true);\n      if (liked) {\n        setLikes((prev) => prev - 1);\n        setLiked(false);\n      }\n    } catch (e) {\n      console.error(\"Dislike failed:\", e);\n    }\n  };\n\n  // Handle share\n  const handleShare = async () => {\n    const url = window.location.href;\n    if (navigator.share) {\n      try {\n        await navigator.share({ title: video?.title, url });\n      } catch (e) {\n        // User cancelled\n      }\n    } else {\n      navigator.clipboard.writeText(url);\n      alert(\"Link copied to clipboard!\");\n    }\n  };\n\n  // Handle report\n  const handleReport = async () => {\n    if (!reportReason.trim()) return;\n    try {\n      await publicAPI.reportVideo(id, { reason: reportReason });\n      setShowReport(false);\n      setReportReason(\"\");\n      alert(\"Report submitted. Thank you!\");\n    } catch (e) {\n      alert(\"Failed to submit report\");\n    }\n  };\n\n  // Get thumbnail URL\n  const getThumbnail = (video) => {\n    if (!video) return PLACEHOLDER;\n    const thumb = video.thumbnail;\n    if (thumb && thumb.startsWith(\"http\")) return thumb;\n    if (thumb && thumb.length > 3) return `https://abyss.to/splash/${thumb}.jpg`;\n    if (video.file_code) return `https://abyss.to/splash/${video.file_code}.jpg`;\n    return PLACEHOLDER;\n  };\n\n  // LOADING STATE\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 dark:bg-dark-400 flex items-center justify-center\">\n        <LoadingSpinner />\n      </div>\n    );\n  }\n\n  // ERROR STATE\n  if (error || !video) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 dark:bg-dark-400 flex flex-col items-center justify-center px-4\">\n        <div className=\"text-6xl mb-4\">ðŸ˜•</div>\n        <h2 className=\"text-2xl font-bold text-white mb-2\">Video Not Found</h2>\n        <p className=\"text-gray-400 mb-6\">{error || \"This video may have been removed.\"}</p>\n        <Link to=\"/\" className=\"btn-primary px-6 py-3\">\n          Go Home\n        </Link>\n      </div>\n    );\n  }\n\n  const embedUrl = video.embed_code || video.embedUrl || \"\";\n  const duration = video.duration && video.duration !== \"00:00\" ? video.duration : null;\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-dark-400\">\n      <div className=\"max-w-[1400px] mx-auto px-0 sm:px-4 lg:px-6 py-0 sm:py-4\">\n        <div className=\"flex flex-col lg:flex-row gap-0 sm:gap-6\">\n          {/* ==================== LEFT: VIDEO + INFO ==================== */}\n          <div className=\"flex-1 min-w-0\">\n            {/* Video Player */}\n            <div className=\"relative w-full bg-black sm:rounded-xl overflow-hidden\">\n              <div className=\"relative pt-[56.25%]\">\n                {embedUrl ? (\n                  <iframe\n                    src={embedUrl}\n                    className=\"absolute inset-0 w-full h-full\"\n                    frameBorder=\"0\"\n                    scrolling=\"no\"\n                    allowFullScreen\n                    title={video.title}\n                    allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n                  />\n                ) : (\n                  <div className=\"absolute inset-0 flex items-center justify-center text-gray-400\">\n                    <p>Video not available</p>\n                  </div>\n                )}\n              </div>\n            </div>\n\n            {/* Video Info */}\n            <div className=\"px-4 sm:px-0 mt-3\">\n              {/* Title */}\n              <h1 className=\"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900 dark:text-white leading-tight\">\n                {video.title}\n              </h1>\n\n              {/* Meta Row */}\n              <div className=\"flex flex-wrap items-center gap-x-3 gap-y-1 mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                <span className=\"flex items-center gap-1\">\n                  <FiEye className=\"w-4 h-4\" />\n                  {formatViews(video.views || 0)} views\n                </span>\n                <span>â€¢</span>\n                <span className=\"flex items-center gap-1\">\n                  <FiCalendar className=\"w-4 h-4\" />\n                  {formatDate(video.uploadDate || video.createdAt)}\n                </span>\n                {duration && (\n                  <>\n                    <span>â€¢</span>\n                    <span className=\"flex items-center gap-1\">\n                      <FiClock className=\"w-4 h-4\" />\n                      {duration}\n                    </span>\n                  </>\n                )}\n              </div>\n\n              {/* Action Buttons */}\n              <div className=\"flex flex-wrap items-center gap-2 mt-4 pb-4 border-b border-gray-200 dark:border-dark-100\">\n                {/* Like */}\n                <button\n                  onClick={handleLike}\n                  className={`flex items-center gap-1.5 px-4 py-2 rounded-full text-sm font-medium transition-all ${\n                    liked\n                      ? \"bg-primary-600 text-white\"\n                      : \"bg-gray-100 dark:bg-dark-100 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-200\"\n                  }`}\n                >\n                  <FiThumbsUp className=\"w-4 h-4\" />\n                  <span>{formatViews(likes)}</span>\n                </button>\n\n                {/* Dislike */}\n                <button\n                  onClick={handleDislike}\n                  className={`flex items-center gap-1.5 px-4 py-2 rounded-full text-sm font-medium transition-all ${\n                    disliked\n                      ? \"bg-gray-600 text-white\"\n                      : \"bg-gray-100 dark:bg-dark-100 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-200\"\n                  }`}\n                >\n                  <FiThumbsDown className=\"w-4 h-4\" />\n                  <span>{formatViews(dislikes)}</span>\n                </button>\n\n                {/* Share */}\n                <button\n                  onClick={handleShare}\n                  className=\"flex items-center gap-1.5 px-4 py-2 rounded-full text-sm font-medium bg-gray-100 dark:bg-dark-100 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-200 transition-all\"\n                >\n                  <FiShare2 className=\"w-4 h-4\" />\n                  <span className=\"hidden sm:inline\">Share</span>\n                </button>\n\n                {/* Report */}\n                <button\n                  onClick={() => setShowReport(!showReport)}\n                  className=\"flex items-center gap-1.5 px-4 py-2 rounded-full text-sm font-medium bg-gray-100 dark:bg-dark-100 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-200 transition-all ml-auto\"\n                >\n                  <FiFlag className=\"w-4 h-4\" />\n                  <span className=\"hidden sm:inline\">Report</span>\n                </button>\n              </div>\n\n              {/* Report Form */}\n              {showReport && (\n                <div className=\"mt-3 p-4 bg-gray-100 dark:bg-dark-200 rounded-xl animate-fade-in\">\n                  <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-2\">Report Video</h4>\n                  <select\n                    value={reportReason}\n                    onChange={(e) => setReportReason(e.target.value)}\n                    className=\"w-full px-3 py-2 bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-100 rounded-lg text-sm text-gray-900 dark:text-white mb-2\"\n                  >\n                    <option value=\"\">Select reason...</option>\n                    <option value=\"inappropriate\">Inappropriate Content</option>\n                    <option value=\"copyright\">Copyright Violation</option>\n                    <option value=\"spam\">Spam / Misleading</option>\n                    <option value=\"broken\">Video Not Working</option>\n                    <option value=\"other\">Other</option>\n                  </select>\n                  <div className=\"flex gap-2\">\n                    <button\n                      onClick={handleReport}\n                      disabled={!reportReason}\n                      className=\"px-4 py-2 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      Submit Report\n                    </button>\n                    <button\n                      onClick={() => setShowReport(false)}\n                      className=\"px-4 py-2 bg-gray-200 dark:bg-dark-100 text-gray-700 dark:text-gray-300 text-sm rounded-lg\"\n                    >\n                      Cancel\n                    </button>\n                  </div>\n                </div>\n              )}\n\n              {/* Description */}\n              {video.description && (\n                <div className=\"mt-4\">\n                  <div\n                    className={`bg-gray-100 dark:bg-dark-200 rounded-xl p-4 cursor-pointer transition-all ${\n                      descExpanded ? \"\" : \"max-h-24 overflow-hidden\"\n                    }`}\n                    onClick={() => setDescExpanded(!descExpanded)}\n                  >\n                    <p className=\"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap leading-relaxed\">\n                      {video.description}\n                    </p>\n                  </div>\n                  {video.description.length > 150 && (\n                    <button\n                      onClick={() => setDescExpanded(!descExpanded)}\n                      className=\"flex items-center gap-1 mt-2 text-sm text-primary-600 hover:text-primary-700 font-medium\"\n                    >\n                      {descExpanded ? (\n                        <>\n                          Show less <FiChevronUp className=\"w-4 h-4\" />\n                        </>\n                      ) : (\n                        <>\n                          Show more <FiChevronDown className=\"w-4 h-4\" />\n                        </>\n                      )}\n                    </button>\n                  )}\n                </div>\n              )}\n\n              {/* Category & Tags */}\n              <div className=\"flex flex-wrap items-center gap-2 mt-4 mb-6\">\n                {video.category && (\n                  <span className=\"px-3 py-1 bg-primary-600/10 text-primary-600 text-xs font-medium rounded-full\">\n                    {typeof video.category === \"string\" ? video.category : video.category?.name || \"General\"}\n                  </span>\n                )}\n                {video.tags?.map((tag, i) => (\n                  <Link\n                    key={i}\n                    to={`/tag/${tag}`}\n                    className=\"px-3 py-1 bg-gray-100 dark:bg-dark-100 text-gray-600 dark:text-gray-400 text-xs rounded-full hover:bg-gray-200 dark:hover:bg-dark-200 transition-colors\"\n                  >\n                    #{tag}\n                  </Link>\n                ))}\n              </div>\n            </div>\n\n            {/* ==================== MOBILE: Related Videos Below ==================== */}\n            <div className=\"lg:hidden px-4 sm:px-0 mt-2 mb-8\">\n              <RelatedVideosList\n                videos={relatedVideos}\n                getThumbnail={getThumbnail}\n                currentVideoId={id}\n              />\n            </div>\n          </div>\n\n          {/* ==================== RIGHT SIDEBAR: Related Videos (Desktop) ==================== */}\n          <div className=\"hidden lg:block w-[400px] flex-shrink-0\">\n            <div className=\"sticky top-20\">\n              <RelatedVideosList\n                videos={relatedVideos}\n                getThumbnail={getThumbnail}\n                currentVideoId={id}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// ==================== RELATED VIDEOS LIST COMPONENT ====================\nconst RelatedVideosList = ({ videos, getThumbnail, currentVideoId }) => {\n  if (!videos || videos.length === 0) {\n    return (\n      <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n        <p className=\"text-sm\">No recommendations available</p>\n      </div>\n    );\n  }\n\n  return (\n    <div>\n      <h3 className=\"text-base font-bold text-gray-900 dark:text-white mb-4\">\n        Recommended Videos\n      </h3>\n      <div className=\"space-y-3\">\n        {videos\n          .filter((v) => v._id !== currentVideoId)\n          .slice(0, 15)\n          .map((v) => (\n            <RelatedVideoCard key={v._id} video={v} getThumbnail={getThumbnail} />\n          ))}\n      </div>\n    </div>\n  );\n};\n\n// ==================== SINGLE RELATED VIDEO CARD ====================\nconst RelatedVideoCard = ({ video, getThumbnail }) => {\n  const [imgError, setImgError] = useState(false);\n\n  return (\n    <Link\n      to={`/watch/${video._id}${video.slug ? `/${video.slug}` : \"\"}`}\n      className=\"flex gap-3 group rounded-lg hover:bg-gray-100 dark:hover:bg-dark-200 p-1.5 transition-colors\"\n    >\n      {/* Thumbnail */}\n      <div className=\"relative w-[168px] min-w-[168px] sm:w-[180px] sm:min-w-[180px]\">\n        <div className=\"aspect-video rounded-lg overflow-hidden bg-gray-200 dark:bg-dark-100\">\n          <img\n            src={imgError ? PLACEHOLDER : getThumbnail(video)}\n            alt={video.title}\n            className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300\"\n            loading=\"lazy\"\n            onError={() => setImgError(true)}\n          />\n        </div>\n        {/* Duration badge */}\n        {video.duration && video.duration !== \"00:00\" && (\n          <span className=\"absolute bottom-1 right-1 px-1.5 py-0.5 bg-black/80 text-white text-[10px] font-medium rounded\">\n            {video.duration}\n          </span>\n        )}\n      </div>\n\n      {/* Info */}\n      <div className=\"flex-1 min-w-0 py-0.5\">\n        <h4 className=\"text-sm font-medium text-gray-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-500 line-clamp-2 leading-snug transition-colors\">\n          {video.title}\n        </h4>\n        <div className=\"mt-1.5 space-y-0.5\">\n          <p className=\"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1\">\n            <FiEye className=\"w-3 h-3\" />\n            {formatViews(video.views || 0)} views\n          </p>\n          <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n            {formatRelativeDate(video.uploadDate || video.createdAt)}\n          </p>\n        </div>\n      </div>\n    </Link>\n  );\n};\n\nexport default WatchPage;"],"names":["PLACEHOLDER","formatViews","views","toFixed","replace","toString","formatDate","date","d","Date","isNaN","getTime","toLocaleDateString","year","month","day","formatRelativeDate","now","past","diff","Math","floor","concat","RelatedVideosList","_ref","videos","getThumbnail","currentVideoId","length","_jsxs","children","_jsx","className","filter","v","_id","slice","map","RelatedVideoCard","video","_ref2","imgError","setImgError","useState","Link","to","slug","src","alt","title","loading","onError","duration","FiEye","uploadDate","createdAt","_video$category","_video$tags","id","useParams","setVideo","relatedVideos","setRelatedVideos","setLoading","error","setError","descExpanded","setDescExpanded","likes","setLikes","dislikes","setDislikes","liked","setLiked","disliked","setDisliked","showReport","setShowReport","reportReason","setReportReason","useEffect","async","_response$data","_response$data2","response","publicAPI","getVideo","videoData","data","recordView","e","_relatedRes$data","relatedRes","getRelatedVideos","success","_latestRes$data","latestRes","getLatestVideos","filtered","e2","console","err","fetchData","window","scrollTo","top","behavior","thumb","thumbnail","startsWith","file_code","LoadingSpinner","embedUrl","embed_code","frameBorder","scrolling","allowFullScreen","allow","FiCalendar","_Fragment","FiClock","onClick","likeVideo","prev","FiThumbsUp","dislikeVideo","FiThumbsDown","url","location","href","navigator","share","clipboard","writeText","alert","FiShare2","FiFlag","value","onChange","target","trim","reportVideo","reason","disabled","description","FiChevronUp","FiChevronDown","category","name","tags","tag","i"],"sourceRoot":""}