"use strict";(self.webpackChunkxmaster_frontend=self.webpackChunkxmaster_frontend||[]).push([[411],{8411(e,a,t){t.r(a),t.d(a,{default:()=>u});var r=t(5043),s=t(5475),i=t(3216),l=t(5772),n=t(6305),d=t(6630),o=t(579);const c="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIwIiBoZWlnaHQ9IjE4MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMWUxZTFlIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNiIgZmlsbD0iIzY2NiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIFRodW1ibmFpbDwvdGV4dD48L3N2Zz4=",x=e=>e?e>=1e6?(e/1e6).toFixed(1).replace(/\.0$/,"")+"M":e>=1e3?(e/1e3).toFixed(1).replace(/\.0$/,"")+"K":e.toString():"0",m=e=>{if(!e)return"Unknown";const a=new Date(e);return isNaN(a.getTime())?"Unknown":a.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},g=e=>{if(!e)return"";const a=new Date,t=new Date(e);if(isNaN(t.getTime()))return"";const r=Math.floor((a-t)/1e3);return r<60?"Just now":r<3600?"".concat(Math.floor(r/60),"m ago"):r<86400?"".concat(Math.floor(r/3600),"h ago"):r<604800?"".concat(Math.floor(r/86400),"d ago"):r<2592e3?"".concat(Math.floor(r/604800),"w ago"):m(e)};const h=e=>{let{videos:a,getThumbnail:t,currentVideoId:r}=e;return a&&0!==a.length?(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-base font-bold text-gray-900 dark:text-white mb-4",children:"Recommended Videos"}),(0,o.jsx)("div",{className:"space-y-3",children:a.filter(e=>e._id!==r).slice(0,15).map(e=>(0,o.jsx)(p,{video:e,getThumbnail:t},e._id))})]}):(0,o.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:(0,o.jsx)("p",{className:"text-sm",children:"No recommendations available"})})},p=e=>{let{video:a,getThumbnail:t}=e;const[i,n]=(0,r.useState)(!1);return(0,o.jsxs)(s.N_,{to:"/watch/".concat(a._id).concat(a.slug?"/".concat(a.slug):""),className:"flex gap-3 group rounded-lg hover:bg-gray-100 dark:hover:bg-dark-200 p-1.5 transition-colors",children:[(0,o.jsxs)("div",{className:"relative w-[168px] min-w-[168px] sm:w-[180px] sm:min-w-[180px]",children:[(0,o.jsx)("div",{className:"aspect-video rounded-lg overflow-hidden bg-gray-200 dark:bg-dark-100",children:(0,o.jsx)("img",{src:i?c:t(a),alt:a.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy",onError:()=>n(!0)})}),a.duration&&"00:00"!==a.duration&&(0,o.jsx)("span",{className:"absolute bottom-1 right-1 px-1.5 py-0.5 bg-black/80 text-white text-[10px] font-medium rounded",children:a.duration})]}),(0,o.jsxs)("div",{className:"flex-1 min-w-0 py-0.5",children:[(0,o.jsx)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-500 line-clamp-2 leading-snug transition-colors",children:a.title}),(0,o.jsxs)("div",{className:"mt-1.5 space-y-0.5",children:[(0,o.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1",children:[(0,o.jsx)(l.Vap,{className:"w-3 h-3"}),x(a.views||0)," views"]}),(0,o.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:g(a.uploadDate||a.createdAt)})]})]})]})},u=function(){var e,a;const{id:t}=(0,i.g)(),[g,p]=(0,r.useState)(null),[u,b]=(0,r.useState)([]),[y,v]=(0,r.useState)(!0),[f,j]=(0,r.useState)(null),[k,N]=(0,r.useState)(!1),[w,I]=(0,r.useState)(0),[S,V]=(0,r.useState)(0),[C,M]=(0,r.useState)(!1),[D,G]=(0,r.useState)(!1),[F,T]=(0,r.useState)(!1),[Z,_]=(0,r.useState)("");(0,r.useEffect)(()=>{(async()=>{v(!0),j(null);try{var e,a;const d=await n.G.getVideo(t),o=(null===(e=d.data)||void 0===e?void 0:e.video)||(null===(a=d.data)||void 0===a?void 0:a.data)||d.data;p(o),I(o.likes||0),V(o.dislikes||0);try{await n.G.recordView(t)}catch(i){}try{var r;const e=await n.G.getRelatedVideos(t,12);null!==(r=e.data)&&void 0!==r&&r.success&&b(e.data.videos||[])}catch(i){try{var s;const e=await n.G.getLatestVideos(12);if(null!==(s=e.data)&&void 0!==s&&s.success){const a=(e.data.videos||[]).filter(e=>e._id!==t);b(a)}}catch(l){console.error("Failed to fetch any recommendations:",l)}}}catch(d){j("Failed to load video"),console.error(d)}finally{v(!1)}})(),window.scrollTo({top:0,behavior:"smooth"})},[t]);const R=e=>{if(!e)return c;const a=e.thumbnail;return a&&a.startsWith("http")?a:a&&a.length>3?"https://abyss.to/splash/".concat(a,".jpg"):e.file_code?"https://abyss.to/splash/".concat(e.file_code,".jpg"):c};if(y)return(0,o.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-dark-400 flex items-center justify-center",children:(0,o.jsx)(d.A,{})});if(f||!g)return(0,o.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-dark-400 flex flex-col items-center justify-center px-4",children:[(0,o.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\ude15"}),(0,o.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Video Not Found"}),(0,o.jsx)("p",{className:"text-gray-400 mb-6",children:f||"This video may have been removed."}),(0,o.jsx)(s.N_,{to:"/",className:"btn-primary px-6 py-3",children:"Go Home"})]});const W=g.embed_code||g.embedUrl||"",A=g.duration&&"00:00"!==g.duration?g.duration:null;return(0,o.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-dark-400",children:(0,o.jsx)("div",{className:"max-w-[1400px] mx-auto px-0 sm:px-4 lg:px-6 py-0 sm:py-4",children:(0,o.jsxs)("div",{className:"flex flex-col lg:flex-row gap-0 sm:gap-6",children:[(0,o.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,o.jsx)("div",{className:"relative w-full bg-black sm:rounded-xl overflow-hidden",children:(0,o.jsx)("div",{className:"relative pt-[56.25%]",children:W?(0,o.jsx)("iframe",{src:W,className:"absolute inset-0 w-full h-full",frameBorder:"0",scrolling:"no",allowFullScreen:!0,title:g.title,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"}):(0,o.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-gray-400",children:(0,o.jsx)("p",{children:"Video not available"})})})}),(0,o.jsxs)("div",{className:"px-4 sm:px-0 mt-3",children:[(0,o.jsx)("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900 dark:text-white leading-tight",children:g.title}),(0,o.jsxs)("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1 mt-2 text-sm text-gray-500 dark:text-gray-400",children:[(0,o.jsxs)("span",{className:"flex items-center gap-1",children:[(0,o.jsx)(l.Vap,{className:"w-4 h-4"}),x(g.views||0)," views"]}),(0,o.jsx)("span",{children:"\u2022"}),(0,o.jsxs)("span",{className:"flex items-center gap-1",children:[(0,o.jsx)(l.wIk,{className:"w-4 h-4"}),m(g.uploadDate||g.createdAt)]}),A&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:"\u2022"}),(0,o.jsxs)("span",{className:"flex items-center gap-1",children:[(0,o.jsx)(l.Ohp,{className:"w-4 h-4"}),A]})]})]}),(0,o.jsxs)("div",{className:"flex flex-wrap items-center gap-2 mt-4 pb-4 border-b border-gray-200 dark:border-dark-100",children:[(0,o.jsxs)("button",{onClick:async()=>{if(!C)try{await n.G.likeVideo(t),I(e=>e+1),M(!0),D&&(V(e=>e-1),G(!1))}catch(e){console.error("Like failed:",e)}},className:"flex items-center gap-1.5 px-4 py-2 rounded-full text-sm font-medium transition-all ".concat(C?"bg-primary-600 text-white":"bg-gray-100 dark:bg-dark-100 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-200"),children:[(0,o.jsx)(l.Ydy,{className:"w-4 h-4"}),(0,o.jsx)("span",{children:x(w)})]}),(0,o.jsxs)("button",{onClick:async()=>{if(!D)try{await n.G.dislikeVideo(t),V(e=>e+1),G(!0),C&&(I(e=>e-1),M(!1))}catch(e){console.error("Dislike failed:",e)}},className:"flex items-center gap-1.5 px-4 py-2 rounded-full text-sm font-medium transition-all ".concat(D?"bg-gray-600 text-white":"bg-gray-100 dark:bg-dark-100 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-200"),children:[(0,o.jsx)(l.rxb,{className:"w-4 h-4"}),(0,o.jsx)("span",{children:x(S)})]}),(0,o.jsxs)("button",{onClick:async()=>{const e=window.location.href;if(navigator.share)try{await navigator.share({title:null===g||void 0===g?void 0:g.title,url:e})}catch(a){}else navigator.clipboard.writeText(e),alert("Link copied to clipboard!")},className:"flex items-center gap-1.5 px-4 py-2 rounded-full text-sm font-medium bg-gray-100 dark:bg-dark-100 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-200 transition-all",children:[(0,o.jsx)(l.Pum,{className:"w-4 h-4"}),(0,o.jsx)("span",{className:"hidden sm:inline",children:"Share"})]}),(0,o.jsxs)("button",{onClick:()=>T(!F),className:"flex items-center gap-1.5 px-4 py-2 rounded-full text-sm font-medium bg-gray-100 dark:bg-dark-100 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-200 transition-all ml-auto",children:[(0,o.jsx)(l.QsL,{className:"w-4 h-4"}),(0,o.jsx)("span",{className:"hidden sm:inline",children:"Report"})]})]}),F&&(0,o.jsxs)("div",{className:"mt-3 p-4 bg-gray-100 dark:bg-dark-200 rounded-xl animate-fade-in",children:[(0,o.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2",children:"Report Video"}),(0,o.jsxs)("select",{value:Z,onChange:e=>_(e.target.value),className:"w-full px-3 py-2 bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-100 rounded-lg text-sm text-gray-900 dark:text-white mb-2",children:[(0,o.jsx)("option",{value:"",children:"Select reason..."}),(0,o.jsx)("option",{value:"inappropriate",children:"Inappropriate Content"}),(0,o.jsx)("option",{value:"copyright",children:"Copyright Violation"}),(0,o.jsx)("option",{value:"spam",children:"Spam / Misleading"}),(0,o.jsx)("option",{value:"broken",children:"Video Not Working"}),(0,o.jsx)("option",{value:"other",children:"Other"})]}),(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsx)("button",{onClick:async()=>{if(Z.trim())try{await n.G.reportVideo(t,{reason:Z}),T(!1),_(""),alert("Report submitted. Thank you!")}catch(e){alert("Failed to submit report")}},disabled:!Z,className:"px-4 py-2 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Submit Report"}),(0,o.jsx)("button",{onClick:()=>T(!1),className:"px-4 py-2 bg-gray-200 dark:bg-dark-100 text-gray-700 dark:text-gray-300 text-sm rounded-lg",children:"Cancel"})]})]}),g.description&&(0,o.jsxs)("div",{className:"mt-4",children:[(0,o.jsx)("div",{className:"bg-gray-100 dark:bg-dark-200 rounded-xl p-4 cursor-pointer transition-all ".concat(k?"":"max-h-24 overflow-hidden"),onClick:()=>N(!k),children:(0,o.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap leading-relaxed",children:g.description})}),g.description.length>150&&(0,o.jsx)("button",{onClick:()=>N(!k),className:"flex items-center gap-1 mt-2 text-sm text-primary-600 hover:text-primary-700 font-medium",children:k?(0,o.jsxs)(o.Fragment,{children:["Show less ",(0,o.jsx)(l.wAb,{className:"w-4 h-4"})]}):(0,o.jsxs)(o.Fragment,{children:["Show more ",(0,o.jsx)(l.fK4,{className:"w-4 h-4"})]})})]}),(0,o.jsxs)("div",{className:"flex flex-wrap items-center gap-2 mt-4 mb-6",children:[g.category&&(0,o.jsx)("span",{className:"px-3 py-1 bg-primary-600/10 text-primary-600 text-xs font-medium rounded-full",children:"string"===typeof g.category?g.category:(null===(e=g.category)||void 0===e?void 0:e.name)||"General"}),null===(a=g.tags)||void 0===a?void 0:a.map((e,a)=>(0,o.jsxs)(s.N_,{to:"/tag/".concat(e),className:"px-3 py-1 bg-gray-100 dark:bg-dark-100 text-gray-600 dark:text-gray-400 text-xs rounded-full hover:bg-gray-200 dark:hover:bg-dark-200 transition-colors",children:["#",e]},a))]})]}),(0,o.jsx)("div",{className:"lg:hidden px-4 sm:px-0 mt-2 mb-8",children:(0,o.jsx)(h,{videos:u,getThumbnail:R,currentVideoId:t})})]}),(0,o.jsx)("div",{className:"hidden lg:block w-[400px] flex-shrink-0",children:(0,o.jsx)("div",{className:"sticky top-20",children:(0,o.jsx)(h,{videos:u,getThumbnail:R,currentVideoId:t})})})]})})})}}}]);
//# sourceMappingURL=411.33e1964c.chunk.js.map