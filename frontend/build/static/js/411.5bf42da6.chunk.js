"use strict";(self.webpackChunkxmaster_frontend=self.webpackChunkxmaster_frontend||[]).push([[411],{8227(e,t,a){a.d(t,{A:()=>l});var r=a(5043),s=a(6305),i=a(579);const l=e=>{let{placement:t="home_top",className:a=""}=e;const[l,n]=(0,r.useState)(null),d=(0,r.useRef)(null),c=(0,r.useRef)(!1);if((0,r.useEffect)(()=>{(async()=>{try{var e,a;const i=window.innerWidth<768?"mobile":"desktop",l=await s.G.getAdByPlacement(t,i);if(null!==(e=l.data)&&void 0!==e&&e.success&&null!==(a=l.data)&&void 0!==a&&a.ad){n(l.data.ad);try{await s.G.recordAdImpression(l.data.ad._id)}catch(r){}}}catch(i){}})()},[t]),(0,r.useEffect)(()=>{if(!l||!d.current||c.current)return;const e=d.current,t=l.code||l.content||"";if(!t.trim())return;e.innerHTML="",c.current=!0;const a=document.createElement("div");a.innerHTML=t;const r=a.querySelectorAll("script"),s=t.replace(/<script[\s\S]*?<\/script>/gi,"");if(s.trim()){const t=document.createElement("div");t.innerHTML=s,e.appendChild(t)}return r.forEach(t=>{const a=document.createElement("script");Array.from(t.attributes).forEach(e=>{a.setAttribute(e.name,e.value)}),t.textContent&&(a.textContent=t.textContent),t.src&&(a.src=t.src,a.async=!0),e.appendChild(a)}),()=>{e&&(e.innerHTML=""),c.current=!1}},[l]),(0,r.useEffect)(()=>{c.current=!1},[t]),!l)return null;if("image"===l.type||"banner"===l.type){const e=l.imageUrl||l.image||"",t=l.targetUrl||l.url||l.link||"#";return e?(0,i.jsx)("div",{className:"ad-banner flex justify-center ".concat(a),children:(0,i.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer nofollow",onClick:async()=>{try{await s.G.recordAdClick(l._id)}catch(e){}},children:(0,i.jsx)("img",{src:e,alt:l.name||"Advertisement",className:"rounded-lg max-w-full",loading:"lazy"})})}):null}return(0,i.jsx)("div",{className:"ad-banner flex justify-center ".concat(a),children:(0,i.jsx)("div",{ref:d,className:"ad-content"})})}},8411(e,t,a){a.r(t),a.d(t,{default:()=>b});var r=a(5043),s=a(5475),i=a(3216),l=a(5772),n=a(6305),d=a(6630),c=a(8227),o=a(579);const m="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIwIiBoZWlnaHQ9IjE4MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMWUxZTFlIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNiIgZmlsbD0iIzY2NiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIFRodW1ibmFpbDwvdGV4dD48L3N2Zz4=",x=e=>e?e>=1e6?(e/1e6).toFixed(1).replace(/\.0$/,"")+"M":e>=1e3?(e/1e3).toFixed(1).replace(/\.0$/,"")+"K":e.toString():"0",h=e=>{if(!e)return"Unknown";const t=new Date(e);return isNaN(t.getTime())?"Unknown":t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},g=e=>{if(!e)return"";const t=new Date,a=new Date(e);if(isNaN(a.getTime()))return"";const r=Math.floor((t-a)/1e3);return r<60?"Just now":r<3600?"".concat(Math.floor(r/60),"m ago"):r<86400?"".concat(Math.floor(r/3600),"h ago"):r<604800?"".concat(Math.floor(r/86400),"d ago"):r<2592e3?"".concat(Math.floor(r/604800),"w ago"):h(e)};const p=e=>{let{videos:t,getThumbnail:a,currentVideoId:r}=e;return t&&0!==t.length?(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-base font-bold text-gray-900 dark:text-white mb-4",children:"Recommended Videos"}),(0,o.jsx)("div",{className:"space-y-3",children:t.filter(e=>e._id!==r).slice(0,15).map(e=>(0,o.jsx)(u,{video:e,getThumbnail:a},e._id))})]}):(0,o.jsx)("div",{className:"text-center py-8 text-gray-500",children:(0,o.jsx)("p",{className:"text-sm",children:"No recommendations"})})},u=e=>{let{video:t,getThumbnail:a}=e;const[i,n]=(0,r.useState)(!1);return(0,o.jsxs)(s.N_,{to:"/watch/".concat(t._id).concat(t.slug?"/".concat(t.slug):""),className:"flex gap-3 group rounded-lg hover:bg-gray-100 dark:hover:bg-dark-200 p-1.5 transition-colors",children:[(0,o.jsxs)("div",{className:"relative w-[168px] min-w-[168px] sm:w-[180px] sm:min-w-[180px]",children:[(0,o.jsx)("div",{className:"aspect-video rounded-lg overflow-hidden bg-gray-200 dark:bg-dark-100",children:(0,o.jsx)("img",{src:i?m:a(t),alt:t.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy",onError:()=>n(!0)})}),t.duration&&"00:00"!==t.duration&&(0,o.jsx)("span",{className:"absolute bottom-1 right-1 px-1.5 py-0.5 bg-black/80 text-white text-[10px] font-medium rounded",children:t.duration})]}),(0,o.jsxs)("div",{className:"flex-1 min-w-0 py-0.5",children:[(0,o.jsx)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white group-hover:text-primary-600 line-clamp-2 leading-snug transition-colors",children:t.title}),(0,o.jsxs)("div",{className:"mt-1.5 space-y-0.5",children:[(0,o.jsxs)("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[(0,o.jsx)(l.Vap,{className:"w-3 h-3"}),x(t.views||0)," views"]}),(0,o.jsx)("p",{className:"text-xs text-gray-500",children:g(t.uploadDate||t.createdAt)})]})]})]})},b=function(){var e,t;const{id:a}=(0,i.g)(),[g,u]=(0,r.useState)(null),[b,y]=(0,r.useState)([]),[f,v]=(0,r.useState)(!0),[j,w]=(0,r.useState)(null),[N,k]=(0,r.useState)(!1),[S,I]=(0,r.useState)(0),[C,V]=(0,r.useState)(0),[A,M]=(0,r.useState)(!1),[_,G]=(0,r.useState)(!1),[T,D]=(0,r.useState)(!1),[Z,F]=(0,r.useState)("");(0,r.useEffect)(()=>{(async()=>{v(!0),w(null);try{var e,t;const d=await n.G.getVideo(a),c=(null===(e=d.data)||void 0===e?void 0:e.video)||(null===(t=d.data)||void 0===t?void 0:t.data)||d.data;u(c),I(c.likes||0),V(c.dislikes||0);try{await n.G.recordView(a)}catch(i){}try{var r;const e=await n.G.getRelatedVideos(a,12);null!==(r=e.data)&&void 0!==r&&r.success&&y(e.data.videos||[])}catch(i){try{var s;const e=await n.G.getLatestVideos(12);null!==(s=e.data)&&void 0!==s&&s.success&&y((e.data.videos||[]).filter(e=>e._id!==a))}catch(l){}}}catch(d){w("Failed to load video")}finally{v(!1)}})(),window.scrollTo({top:0,behavior:"smooth"})},[a]);const R=e=>{if(!e)return m;const t=e.thumbnail;return t&&t.startsWith("http")?t:t&&t.length>3?"https://abyss.to/splash/".concat(t,".jpg"):e.file_code?"https://abyss.to/splash/".concat(e.file_code,".jpg"):m};if(f)return(0,o.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-dark-400 flex items-center justify-center",children:(0,o.jsx)(d.A,{})});if(j||!g)return(0,o.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-dark-400 flex flex-col items-center justify-center px-4",children:[(0,o.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\ude15"}),(0,o.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Video Not Found"}),(0,o.jsx)("p",{className:"text-gray-400 mb-6",children:j||"This video may have been removed."}),(0,o.jsx)(s.N_,{to:"/",className:"btn-primary px-6 py-3",children:"Go Home"})]});const E=g.embed_code||g.embedUrl||"",H=g.duration&&"00:00"!==g.duration?g.duration:null;return(0,o.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-dark-400",children:(0,o.jsx)("div",{className:"max-w-[1400px] mx-auto px-0 sm:px-4 lg:px-6 py-0 sm:py-4",children:(0,o.jsxs)("div",{className:"flex flex-col lg:flex-row gap-0 sm:gap-6",children:[(0,o.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,o.jsx)("div",{className:"relative w-full bg-black sm:rounded-xl overflow-hidden",children:(0,o.jsx)("div",{className:"relative pt-[56.25%]",children:E?(0,o.jsx)("iframe",{src:E,className:"absolute inset-0 w-full h-full",frameBorder:"0",scrolling:"no",allowFullScreen:!0,title:g.title,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"}):(0,o.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-gray-400",children:(0,o.jsx)("p",{children:"Video not available"})})})}),(0,o.jsx)("div",{className:"px-4 sm:px-0 mt-3",children:(0,o.jsx)(c.A,{placement:"watch_below",className:"mb-4"})}),(0,o.jsxs)("div",{className:"px-4 sm:px-0",children:[(0,o.jsx)("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900 dark:text-white leading-tight",children:g.title}),(0,o.jsxs)("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1 mt-2 text-sm text-gray-500 dark:text-gray-400",children:[(0,o.jsxs)("span",{className:"flex items-center gap-1",children:[(0,o.jsx)(l.Vap,{className:"w-4 h-4"}),x(g.views||0)," views"]}),(0,o.jsx)("span",{children:"\u2022"}),(0,o.jsxs)("span",{className:"flex items-center gap-1",children:[(0,o.jsx)(l.wIk,{className:"w-4 h-4"}),h(g.uploadDate||g.createdAt)]}),H&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:"\u2022"}),(0,o.jsxs)("span",{className:"flex items-center gap-1",children:[(0,o.jsx)(l.Ohp,{className:"w-4 h-4"}),H]})]})]}),(0,o.jsxs)("div",{className:"flex flex-wrap items-center gap-2 mt-4 pb-4 border-b border-gray-200 dark:border-dark-100",children:[(0,o.jsxs)("button",{onClick:async()=>{if(!A)try{await n.G.likeVideo(a),I(e=>e+1),M(!0),_&&(V(e=>e-1),G(!1))}catch(e){}},className:"flex items-center gap-1.5 px-4 py-2 rounded-full text-sm font-medium transition-all ".concat(A?"bg-primary-600 text-white":"bg-gray-100 dark:bg-dark-100 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-200"),children:[(0,o.jsx)(l.Ydy,{className:"w-4 h-4"}),(0,o.jsx)("span",{children:x(S)})]}),(0,o.jsxs)("button",{onClick:async()=>{if(!_)try{await n.G.dislikeVideo(a),V(e=>e+1),G(!0),A&&(I(e=>e-1),M(!1))}catch(e){}},className:"flex items-center gap-1.5 px-4 py-2 rounded-full text-sm font-medium transition-all ".concat(_?"bg-gray-600 text-white":"bg-gray-100 dark:bg-dark-100 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-200"),children:[(0,o.jsx)(l.rxb,{className:"w-4 h-4"}),(0,o.jsx)("span",{children:x(C)})]}),(0,o.jsxs)("button",{onClick:async()=>{const e=window.location.href;if(navigator.share)try{await navigator.share({title:null===g||void 0===g?void 0:g.title,url:e})}catch(t){}else navigator.clipboard.writeText(e),alert("Link copied!")},className:"flex items-center gap-1.5 px-4 py-2 rounded-full text-sm font-medium bg-gray-100 dark:bg-dark-100 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-200 transition-all",children:[(0,o.jsx)(l.Pum,{className:"w-4 h-4"}),(0,o.jsx)("span",{className:"hidden sm:inline",children:"Share"})]}),(0,o.jsxs)("button",{onClick:()=>D(!T),className:"flex items-center gap-1.5 px-4 py-2 rounded-full text-sm font-medium bg-gray-100 dark:bg-dark-100 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-200 transition-all ml-auto",children:[(0,o.jsx)(l.QsL,{className:"w-4 h-4"}),(0,o.jsx)("span",{className:"hidden sm:inline",children:"Report"})]})]}),T&&(0,o.jsxs)("div",{className:"mt-3 p-4 bg-gray-100 dark:bg-dark-200 rounded-xl animate-fade-in",children:[(0,o.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2",children:"Report Video"}),(0,o.jsxs)("select",{value:Z,onChange:e=>F(e.target.value),className:"w-full px-3 py-2 bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-100 rounded-lg text-sm text-gray-900 dark:text-white mb-2",children:[(0,o.jsx)("option",{value:"",children:"Select reason..."}),(0,o.jsx)("option",{value:"inappropriate",children:"Inappropriate Content"}),(0,o.jsx)("option",{value:"copyright",children:"Copyright Violation"}),(0,o.jsx)("option",{value:"spam",children:"Spam / Misleading"}),(0,o.jsx)("option",{value:"broken",children:"Video Not Working"}),(0,o.jsx)("option",{value:"other",children:"Other"})]}),(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsx)("button",{onClick:async()=>{if(Z.trim())try{await n.G.reportVideo(a,{reason:Z}),D(!1),F(""),alert("Report submitted!")}catch(e){alert("Failed to submit report")}},disabled:!Z,className:"px-4 py-2 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 disabled:opacity-50",children:"Submit"}),(0,o.jsx)("button",{onClick:()=>D(!1),className:"px-4 py-2 bg-gray-200 dark:bg-dark-100 text-gray-700 dark:text-gray-300 text-sm rounded-lg",children:"Cancel"})]})]}),g.description&&(0,o.jsxs)("div",{className:"mt-4",children:[(0,o.jsx)("div",{className:"bg-gray-100 dark:bg-dark-200 rounded-xl p-4 cursor-pointer transition-all ".concat(N?"":"max-h-24 overflow-hidden"),onClick:()=>k(!N),children:(0,o.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap leading-relaxed",children:g.description})}),g.description.length>150&&(0,o.jsx)("button",{onClick:()=>k(!N),className:"flex items-center gap-1 mt-2 text-sm text-primary-600 hover:text-primary-700 font-medium",children:N?(0,o.jsxs)(o.Fragment,{children:["Show less ",(0,o.jsx)(l.wAb,{className:"w-4 h-4"})]}):(0,o.jsxs)(o.Fragment,{children:["Show more ",(0,o.jsx)(l.fK4,{className:"w-4 h-4"})]})})]}),(0,o.jsxs)("div",{className:"flex flex-wrap items-center gap-2 mt-4 mb-6",children:[g.category&&(0,o.jsx)("span",{className:"px-3 py-1 bg-primary-600/10 text-primary-600 text-xs font-medium rounded-full",children:"string"===typeof g.category?g.category:(null===(e=g.category)||void 0===e?void 0:e.name)||"General"}),null===(t=g.tags)||void 0===t?void 0:t.map((e,t)=>(0,o.jsxs)(s.N_,{to:"/tag/".concat(e),className:"px-3 py-1 bg-gray-100 dark:bg-dark-100 text-gray-600 dark:text-gray-400 text-xs rounded-full hover:bg-gray-200 dark:hover:bg-dark-200 transition-colors",children:["#",e]},t))]})]}),(0,o.jsxs)("div",{className:"lg:hidden px-4 sm:px-0 mt-2 mb-8",children:[(0,o.jsx)(c.A,{placement:"watch_related",className:"mb-4"}),(0,o.jsx)(p,{videos:b,getThumbnail:R,currentVideoId:a})]})]}),(0,o.jsx)("div",{className:"hidden lg:block w-[400px] flex-shrink-0",children:(0,o.jsxs)("div",{className:"sticky top-20 space-y-4",children:[(0,o.jsx)(c.A,{placement:"watch_sidebar"}),(0,o.jsx)(p,{videos:b,getThumbnail:R,currentVideoId:a}),(0,o.jsx)(c.A,{placement:"watch_sidebar"})]})})]})})})}}}]);
//# sourceMappingURL=411.5bf42da6.chunk.js.map