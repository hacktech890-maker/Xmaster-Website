"use strict";(self.webpackChunkxmaster_frontend=self.webpackChunkxmaster_frontend||[]).push([[811],{5992(e,s,t){t.d(s,{A:()=>o});var a=t(5043),l=t(3216),r=t(5475),i=t(5772),d=t(5187),c=t(579);const n=()=>{const[e,s]=(0,a.useState)(!1),t=(0,l.zy)(),n=(0,l.Zp)(),{logout:o}=(0,d.As)(),x=[{name:"Dashboard",path:"/admin/dashboard",icon:i.V5Y},{name:"Videos",path:"/admin/videos",icon:i.pVQ},{name:"Upload",path:"/admin/upload",icon:i.B88},{name:"Categories",path:"/admin/categories",icon:i.QPV},{name:"Comments",path:"/admin/comments",icon:i.mEP},{name:"Duplicates",path:"/admin/duplicates",icon:i.nxz},{name:"Ads",path:"/admin/ads",icon:i.z8N},{name:"Reports",path:"/admin/reports",icon:i.QsL}],m=()=>{o(),n("/xmaster-admin")},u=()=>(0,c.jsxs)("div",{className:"flex flex-col h-full",children:[(0,c.jsx)("div",{className:"p-4 sm:p-6 border-b border-gray-200 dark:border-dark-100",children:(0,c.jsxs)(r.N_,{to:"/admin/dashboard",className:"flex items-center gap-3",children:[(0,c.jsx)("img",{src:"/logo.jpg",alt:"Xmaster",className:"w-10 h-10 rounded-lg object-cover"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Xmaster"}),(0,c.jsx)("p",{className:"text-xs text-gray-500",children:"Admin Panel"})]})]})}),(0,c.jsx)("nav",{className:"flex-1 p-4 space-y-1 overflow-y-auto",children:x.map(e=>{return(0,c.jsxs)(r.N_,{to:e.path,onClick:()=>s(!1),className:"flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-all ".concat((a=e.path,t.pathname===a?"bg-primary-600 text-white shadow-lg shadow-primary-600/30":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-dark-100")),children:[(0,c.jsx)(e.icon,{className:"w-5 h-5"}),(0,c.jsx)("span",{children:e.name})]},e.path);var a})}),(0,c.jsxs)("div",{className:"p-4 border-t border-gray-200 dark:border-dark-100 space-y-1",children:[(0,c.jsxs)(r.N_,{to:"/",className:"flex items-center gap-3 px-4 py-3 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-dark-100 rounded-lg transition-all",children:[(0,c.jsx)(i.VSk,{className:"w-5 h-5"}),(0,c.jsx)("span",{children:"View Site"})]}),(0,c.jsxs)("button",{onClick:m,className:"flex items-center gap-3 px-4 py-3 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all w-full",children:[(0,c.jsx)(i.QeK,{className:"w-5 h-5"}),(0,c.jsx)("span",{children:"Logout"})]})]})]});return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("button",{onClick:()=>s(!e),className:"fixed top-4 left-4 z-50 md:hidden p-2 bg-white dark:bg-dark-200 border border-gray-200 dark:border-dark-100 rounded-lg shadow-lg",children:e?(0,c.jsx)(i.yGN,{className:"w-5 h-5"}):(0,c.jsx)(i.ND1,{className:"w-5 h-5"})}),e&&(0,c.jsx)("div",{className:"fixed inset-0 bg-black/50 z-30 md:hidden",onClick:()=>s(!1)}),(0,c.jsx)("aside",{className:"fixed top-0 left-0 h-full w-64 bg-white dark:bg-dark-300 border-r border-gray-200 dark:border-dark-100 z-40 transform transition-transform duration-300 ".concat(e?"translate-x-0":"-translate-x-full"," md:translate-x-0"),children:(0,c.jsx)(u,{})})]})},o=e=>{let{children:s,title:t=""}=e;return(0,c.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-dark-400",children:(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)(n,{}),(0,c.jsxs)("div",{className:"flex-1 ml-0 md:ml-64",children:[t&&(0,c.jsx)("div",{className:"bg-white dark:bg-dark-300 border-b border-gray-100 dark:border-dark-100 px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:(0,c.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-white",children:t})}),(0,c.jsx)("div",{className:"p-4 sm:p-6 lg:p-8",children:s})]})]})})}},1811(e,s,t){t.r(s),t.d(s,{default:()=>h});var a=t(9379),l=t(5043),r=t(8789),i=t(5772),d=t(3768),c=t(6305),n=t(5992),o=t(6630),x=t(579);const m=e=>{let{categories:s}=e;const[t,n]=(0,l.useState)([]),[o,m]=(0,l.useState)(!1),[p,g]=(0,l.useState)(!1),[h,b]=(0,l.useState)(0),[f,j]=(0,l.useState)(""),[v,y]=(0,l.useState)("private"),[N,w]=(0,l.useState)(!1),k=(0,l.useCallback)(e=>{const s=e.map(e=>({id:Math.random().toString(36).substr(2,9),file:e,name:e.name,title:e.name.replace(/\.[^/.]+$/,"").replace(/[-_]/g," "),size:e.size,status:"pending",progress:0,error:null,category:f,videoStatus:v,videoId:null}));n(e=>[...e,...s])},[f,v]),{getRootProps:A,getInputProps:C,isDragActive:S}=(0,r.VB)({onDrop:k,accept:{"video/*":[".mp4",".mkv",".avi",".mov",".webm",".flv"]},multiple:!0}),_=(e,s)=>{n(t=>t.map(t=>t.id===e?(0,a.A)((0,a.A)({},t),s):t))},P=async()=>{if(0!==t.length){m(!0),g(!1);for(let i=h;i<t.length;i++){if(p)return void b(i);const n=t[i];if("success"!==n.status){_(n.id,{status:"uploading",progress:0});try{var e,s;const t=new FormData;t.append("video",n.file),t.append("title",n.title),t.append("status",n.videoStatus),n.category&&t.append("category",n.category);const a=(null===(e=(await c.Er.uploadVideo(t,(e,s,t)=>{_(n.id,{progress:e,uploadedBytes:s,totalBytes:t})})).data)||void 0===e||null===(s=e.video)||void 0===s?void 0:s._id)||null;_(n.id,{status:"success",progress:100,videoId:a}),d.Ay.success("Uploaded: ".concat(n.title))}catch(r){var a,l;console.error("Upload failed:",r),_(n.id,{status:"failed",error:(null===(a=r.response)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.error)||"Upload failed"})}}}if(m(!1),b(0),N){const e=t.filter(e=>"success"===e.status&&e.videoId);if(e.length>0)try{const s=e.map(e=>e.videoId);await c.Er.bulkUpdateStatus({ids:s,status:"public"}),d.Ay.success("Published ".concat(s.length," videos!"))}catch(i){d.Ay.error("Failed to auto-publish")}}}},F=t.filter(e=>"pending"===e.status).length,I=t.filter(e=>"success"===e.status).length,V=t.filter(e=>"failed"===e.status).length;return(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Category"}),(0,x.jsxs)("select",{value:f,onChange:e=>j(e.target.value),className:"input-field",children:[(0,x.jsx)("option",{value:"",children:"No Category"}),s.map(e=>(0,x.jsx)("option",{value:e._id,children:e.name},e._id))]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Upload Status"}),(0,x.jsxs)("div",{className:"flex gap-2",children:[(0,x.jsxs)("button",{onClick:()=>y("private"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium transition-all ".concat("private"===v?"bg-red-500/20 text-red-400 border border-red-500/30":"bg-dark-100 text-gray-400 border border-dark-100 hover:text-white"),children:[(0,x.jsx)(i.F5$,{className:"w-4 h-4"}),"Private"]}),(0,x.jsxs)("button",{onClick:()=>y("public"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium transition-all ".concat("public"===v?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-dark-100 text-gray-400 border border-dark-100 hover:text-white"),children:[(0,x.jsx)(i.VeH,{className:"w-4 h-4"}),"Public"]})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Auto-Publish"}),(0,x.jsx)("button",{onClick:()=>w(!N),className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium transition-all border ".concat(N?"bg-green-500/20 text-green-400 border-green-500/30":"bg-dark-100 text-gray-400 border-dark-100 hover:text-white"),children:N?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(i.A3x,{className:"w-4 h-4"})," Auto-publish ON"]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(i._NO,{className:"w-4 h-4"})," Auto-publish OFF"]})}),(0,x.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:N?"Videos will be made public after upload completes":"Videos stay private until you manually publish"})]})]}),(0,x.jsxs)("div",(0,a.A)((0,a.A)({},A()),{},{className:"border-2 border-dashed rounded-xl p-12 text-center cursor-pointer transition-all ".concat(S?"border-primary-500 bg-primary-500/10":"border-dark-100 hover:border-gray-600"),children:[(0,x.jsx)("input",(0,a.A)({},C())),(0,x.jsx)(i.YoE,{className:"w-16 h-16 mx-auto text-gray-500 mb-4"}),(0,x.jsx)("p",{className:"text-lg text-white mb-2",children:S?"Drop videos here...":"Drag & drop videos here"}),(0,x.jsx)("p",{className:"text-gray-500",children:"or click to browse files"}),(0,x.jsx)("p",{className:"text-gray-600 text-sm mt-4",children:"Supports: MP4, MKV, AVI, MOV, WebM, FLV (Max 10GB each)"}),(0,x.jsx)("div",{className:"mt-3 flex items-center justify-center gap-2",children:"private"===v?(0,x.jsxs)("span",{className:"text-xs px-3 py-1 bg-red-500/20 text-red-400 rounded-full flex items-center gap-1",children:[(0,x.jsx)(i.F5$,{className:"w-3 h-3"})," Uploads will be Private"]}):(0,x.jsxs)("span",{className:"text-xs px-3 py-1 bg-green-500/20 text-green-400 rounded-full flex items-center gap-1",children:[(0,x.jsx)(i.VeH,{className:"w-3 h-3"})," Uploads will be Public"]})})]})),t.length>0&&(0,x.jsxs)("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-dark-100 rounded-lg",children:[(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsx)("span",{className:"w-3 h-3 rounded-full bg-gray-500"}),(0,x.jsxs)("span",{className:"text-gray-400",children:["Pending: ",F]})]}),(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsx)("span",{className:"w-3 h-3 rounded-full bg-green-500"}),(0,x.jsxs)("span",{className:"text-gray-400",children:["Completed: ",I]})]}),(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsx)("span",{className:"w-3 h-3 rounded-full bg-red-500"}),(0,x.jsxs)("span",{className:"text-gray-400",children:["Failed: ",V]})]}),(0,x.jsx)("div",{className:"flex-1"}),(0,x.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[I>0&&"private"===v&&(0,x.jsxs)("button",{onClick:async()=>{const e=t.filter(e=>"success"===e.status&&e.videoId);if(0!==e.length)try{const s=e.map(e=>e.videoId),t=await c.Er.bulkUpdateStatus({ids:s,status:"public"});t.data.success&&d.Ay.success("Published ".concat(t.data.modifiedCount," videos!"))}catch(s){d.Ay.error("Failed to publish videos")}else(0,d.Ay)("No completed uploads to publish",{icon:"\ud83d\udced"})},className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium flex items-center gap-2 transition-colors",children:[(0,x.jsx)(i.VeH,{className:"w-4 h-4"}),"Publish ",I," Videos"]}),V>0&&(0,x.jsxs)("button",{onClick:()=>{n(e=>e.map(e=>"failed"===e.status?(0,a.A)((0,a.A)({},e),{},{status:"pending",error:null}):e))},className:"btn-secondary text-sm",children:[(0,x.jsx)(i.jTZ,{className:"w-4 h-4"}),"Retry Failed"]}),I>0&&(0,x.jsx)("button",{onClick:()=>{n(e=>e.filter(e=>"success"!==e.status))},className:"btn-secondary text-sm",children:"Clear Completed"}),!o&&(0,x.jsx)("button",{onClick:()=>{o||n([])},className:"btn-secondary text-sm",children:"Clear All"})]})]}),t.length>0&&(0,x.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,x.jsx)(u,{item:e,categories:s,onUpdate:s=>_(e.id,s),onRemove:()=>{return s=e.id,void n(e=>e.filter(e=>e.id!==s));var s},isUploading:o},e.id))}),t.length>0&&F>0&&(0,x.jsx)("div",{className:"flex justify-center gap-4",children:o?p?(0,x.jsxs)("button",{onClick:()=>{g(!1),P()},className:"btn-primary px-8 py-3 text-lg",children:[(0,x.jsx)(i.aze,{className:"w-5 h-5"}),"Resume Upload"]}):(0,x.jsxs)("button",{onClick:()=>{g(!0)},className:"btn-secondary px-8 py-3 text-lg",children:[(0,x.jsx)(i.GHw,{className:"w-5 h-5"}),"Pause Upload"]}):(0,x.jsxs)("button",{onClick:P,className:"btn-primary px-8 py-3 text-lg",children:[(0,x.jsx)(i.aze,{className:"w-5 h-5"}),"Start Upload (",F," videos)"]})})]})},u=e=>{let{item:s,categories:t,onUpdate:a,onRemove:l,isUploading:r}=e;const d={pending:null,uploading:(0,x.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),success:(0,x.jsx)(i.YrT,{className:"w-4 h-4"}),failed:(0,x.jsx)(i.y3G,{className:"w-4 h-4"})};return(0,x.jsx)("div",{className:"bg-dark-100 rounded-lg p-4 ".concat("failed"===s.status?"border border-red-500/50":""),children:(0,x.jsxs)("div",{className:"flex items-start gap-4",children:[(0,x.jsx)("div",{className:"w-10 h-10 rounded-lg ".concat({pending:"bg-gray-500",uploading:"bg-blue-500",success:"bg-green-500",failed:"bg-red-500"}[s.status]," flex items-center justify-center text-white flex-shrink-0"),children:d[s.status]||(0,x.jsx)(i.QuH,{className:"w-5 h-5"})}),(0,x.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,x.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,x.jsxs)("div",{className:"flex-1",children:["pending"===s.status?(0,x.jsx)("input",{type:"text",value:s.title,onChange:e=>a({title:e.target.value}),className:"w-full bg-transparent text-white font-medium focus:outline-none focus:bg-dark-200 px-2 py-1 rounded -ml-2",placeholder:"Video title"}):(0,x.jsx)("p",{className:"text-white font-medium truncate",children:s.title}),(0,x.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,x.jsxs)("p",{className:"text-gray-500 text-sm",children:[(s.size/1048576).toFixed(2)," MB"]}),(0,x.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full ".concat("private"===s.videoStatus?"bg-red-500/20 text-red-400":"bg-green-500/20 text-green-400"),children:"private"===s.videoStatus?"\ud83d\udd12 Private":"\ud83c\udf10 Public"})]})]}),"pending"===s.status&&(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsxs)("select",{value:s.category,onChange:e=>a({category:e.target.value}),className:"px-3 py-1.5 bg-dark-200 border border-dark-100 rounded text-sm text-white",children:[(0,x.jsx)("option",{value:"",children:"No Category"}),t.map(e=>(0,x.jsx)("option",{value:e._id,children:e.name},e._id))]}),(0,x.jsx)("button",{onClick:()=>a({videoStatus:"private"===s.videoStatus?"public":"private"}),className:"p-2 rounded-lg transition-colors ".concat("private"===s.videoStatus?"bg-red-500/20 text-red-400 hover:bg-red-500/30":"bg-green-500/20 text-green-400 hover:bg-green-500/30"),title:"private"===s.videoStatus?"Click to make Public":"Click to make Private",children:"private"===s.videoStatus?(0,x.jsx)(i.F5$,{className:"w-4 h-4"}):(0,x.jsx)(i.VeH,{className:"w-4 h-4"})})]}),"uploading"!==s.status&&(0,x.jsx)("button",{onClick:l,className:"p-2 hover:bg-dark-200 rounded text-gray-400 hover:text-red-500",children:(0,x.jsx)(i.yGN,{className:"w-4 h-4"})})]}),"uploading"===s.status&&(0,x.jsxs)("div",{className:"mt-3",children:[(0,x.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,x.jsxs)("span",{className:"text-gray-400",children:["Uploading... ",s.uploadedBytes?(s.uploadedBytes/1048576).toFixed(1):(s.size*s.progress/104857600).toFixed(1),"MB / ",s.totalBytes?(s.totalBytes/1048576).toFixed(1):(s.size/1048576).toFixed(1),"MB"]}),(0,x.jsxs)("span",{className:"text-white font-medium",children:[s.progress,"%"]})]}),(0,x.jsx)("div",{className:"w-full h-2.5 bg-dark-200 rounded-full overflow-hidden",children:(0,x.jsx)("div",{className:"h-full bg-gradient-to-r from-primary-500 to-blue-500 transition-all duration-300 rounded-full",style:{width:"".concat(s.progress,"%")}})})]}),"failed"===s.status&&s.error&&(0,x.jsx)("p",{className:"text-red-500 text-sm mt-2",children:s.error}),"success"===s.status&&"private"===s.videoStatus&&(0,x.jsx)("div",{className:"mt-2 flex items-center gap-2",children:(0,x.jsxs)("span",{className:"text-xs text-yellow-400 flex items-center gap-1",children:[(0,x.jsx)(i.F5$,{className:"w-3 h-3"})," Uploaded as Private"]})})]})]})})},p=e=>{let{categories:s}=e;const[t,r]=(0,l.useState)([{file_code:"",title:""}]),[n,o]=(0,l.useState)(""),[m,u]=(0,l.useState)("private"),[p,g]=(0,l.useState)(!1),[h,b]=(0,l.useState)(null),f=(e,s,l)=>{r(t.map((t,r)=>r===e?(0,a.A)((0,a.A)({},t),{},{[s]:l}):t))},j=e=>{const s=e.clipboardData.getData("text").split("\n").filter(e=>e.trim());if(s.length>1){e.preventDefault();const a=s.map(e=>{var s,t;const a=e.split(/[\t,]/);return{file_code:(null===(s=a[0])||void 0===s?void 0:s.trim())||"",title:(null===(t=a[1])||void 0===t?void 0:t.trim())||""}});r([...t.filter(e=>e.file_code),...a])}};return(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsx)("div",{className:"bg-dark-100 rounded-lg p-4",children:(0,x.jsx)("p",{className:"text-gray-300 text-sm",children:"Enter Abyss.to file codes to add videos. You can paste multiple codes (one per line) or with titles (code, title format)."})}),(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Category"}),(0,x.jsxs)("select",{value:n,onChange:e=>o(e.target.value),className:"input-field",children:[(0,x.jsx)("option",{value:"",children:"No Category"}),s.map(e=>(0,x.jsx)("option",{value:e._id,children:e.name},e._id))]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status"}),(0,x.jsxs)("div",{className:"flex gap-2",children:[(0,x.jsxs)("button",{onClick:()=>u("private"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium transition-all border ".concat("private"===m?"bg-red-500/20 text-red-400 border-red-500/30":"bg-dark-100 text-gray-400 border-dark-100"),children:[(0,x.jsx)(i.F5$,{className:"w-4 h-4"})," Private"]}),(0,x.jsxs)("button",{onClick:()=>u("public"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium transition-all border ".concat("public"===m?"bg-green-500/20 text-green-400 border-green-500/30":"bg-dark-100 text-gray-400 border-dark-100"),children:[(0,x.jsx)(i.VeH,{className:"w-4 h-4"})," Public"]})]})]})]}),(0,x.jsx)("div",{className:"space-y-3",children:t.map((e,s)=>(0,x.jsxs)("div",{className:"flex gap-3",children:[(0,x.jsx)("input",{type:"text",value:e.file_code,onChange:e=>f(s,"file_code",e.target.value),onPaste:0===s?j:void 0,placeholder:"File code (e.g., abc123xyz)",className:"input-field flex-1"}),(0,x.jsx)("input",{type:"text",value:e.title,onChange:e=>f(s,"title",e.target.value),placeholder:"Title (optional)",className:"input-field flex-1"}),(0,x.jsx)("button",{onClick:()=>(e=>{r(t.filter((s,t)=>t!==e))})(s),className:"p-3 hover:bg-dark-100 rounded-lg text-gray-400 hover:text-red-500",disabled:1===t.length,children:(0,x.jsx)(i.yGN,{className:"w-5 h-5"})})]},s))}),(0,x.jsxs)("button",{onClick:()=>{r([...t,{file_code:"",title:""}])},className:"btn-secondary w-full",children:[(0,x.jsx)(i.GGD,{className:"w-5 h-5"}),"Add Another"]}),(0,x.jsx)("button",{onClick:async()=>{const e=t.filter(e=>e.file_code.trim());if(0!==e.length){g(!0),b(null);try{const s=e.map(e=>({file_code:e.file_code.trim(),title:e.title.trim()||e.file_code.trim(),category:n||null,status:m})),a=await c.Er.bulkAddFileCodes(s);b(a.data.results);const l=a.data.results.success.map(e=>e.file_code);r(t.filter(e=>!l.includes(e.file_code.trim()))),a.data.results.success.length>0&&d.Ay.success("Added ".concat(a.data.results.success.length," videos (").concat(m,")")),a.data.results.failed.length>0&&d.Ay.error("".concat(a.data.results.failed.length," failed"))}catch(s){d.Ay.error("Failed to add videos")}finally{g(!1)}}else d.Ay.error("Please enter at least one file code")},disabled:p,className:"btn-primary w-full py-3",children:p?"Adding Videos...":"Add ".concat(t.filter(e=>e.file_code.trim()).length," Videos (").concat(m,")")}),h&&(0,x.jsxs)("div",{className:"space-y-4",children:[h.success.length>0&&(0,x.jsxs)("div",{className:"bg-green-500/10 border border-green-500/20 rounded-lg p-4",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,x.jsxs)("h4",{className:"text-green-500 font-medium",children:["Successfully Added (",h.success.length,")"]}),"private"===m&&(0,x.jsxs)("button",{onClick:async()=>{if(h&&0!==h.success.length)try{const e=h.success.map(e=>e.id),s=await c.Er.bulkUpdateStatus({ids:e,status:"public"});s.data.success&&d.Ay.success("Published ".concat(s.data.modifiedCount," videos!"))}catch(e){d.Ay.error("Failed to publish")}},className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium flex items-center gap-2 transition-colors",children:[(0,x.jsx)(i.VeH,{className:"w-4 h-4"}),"Publish All"]})]}),(0,x.jsx)("div",{className:"space-y-1 text-sm text-green-400",children:h.success.map((e,s)=>(0,x.jsxs)("p",{children:[e.file_code," - ",e.title]},s))})]}),h.failed.length>0&&(0,x.jsxs)("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4",children:[(0,x.jsxs)("h4",{className:"text-red-500 font-medium mb-2",children:["Failed (",h.failed.length,")"]}),(0,x.jsx)("div",{className:"space-y-1 text-sm",children:h.failed.map((e,s)=>(0,x.jsxs)("p",{className:"text-red-400",children:[e.file_code,": ",e.error]},s))})]})]})]})},g=e=>{let{categories:s}=e;const[t,r]=(0,l.useState)([]),[n,m]=(0,l.useState)(!0),[u,p]=(0,l.useState)([]),[g,h]=(0,l.useState)(!1),[b,f]=(0,l.useState)(1),[j,v]=(0,l.useState)({total:0}),[y,N]=(0,l.useState)(""),[w,k]=(0,l.useState)("private");(0,l.useEffect)(()=>{A()},[b]);const A=async()=>{m(!0);try{const e=await c.Er.getAbyssFiles(b,50);e.data.success&&(r(e.data.files),v(e.data.pagination))}catch(e){d.Ay.error("Failed to fetch files from Abyss")}finally{m(!1)}};return n?(0,x.jsx)(o.A,{}):(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[(0,x.jsxs)("div",{className:"flex items-center gap-4 flex-wrap",children:[(0,x.jsxs)("select",{value:y,onChange:e=>N(e.target.value),className:"input-field w-48",children:[(0,x.jsx)("option",{value:"",children:"No Category"}),s.map(e=>(0,x.jsx)("option",{value:e._id,children:e.name},e._id))]}),(0,x.jsxs)("div",{className:"flex gap-2",children:[(0,x.jsxs)("button",{onClick:()=>k("private"),className:"flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm font-medium transition-all border ".concat("private"===w?"bg-red-500/20 text-red-400 border-red-500/30":"bg-dark-100 text-gray-400 border-dark-100"),children:[(0,x.jsx)(i.F5$,{className:"w-3.5 h-3.5"})," Private"]}),(0,x.jsxs)("button",{onClick:()=>k("public"),className:"flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm font-medium transition-all border ".concat("public"===w?"bg-green-500/20 text-green-400 border-green-500/30":"bg-dark-100 text-gray-400 border-dark-100"),children:[(0,x.jsx)(i.VeH,{className:"w-3.5 h-3.5"})," Public"]})]}),(0,x.jsx)("button",{onClick:()=>{const e=t.filter(e=>!e.alreadyAdded).map(e=>e.file_code);u.length===e.length?p([]):p(e)},className:"btn-secondary",children:"Select All Available"})]}),u.length>0&&(0,x.jsx)("button",{onClick:async()=>{if(0!==u.length){h(!0);try{const e=u.map(e=>{const s=t.find(s=>s.file_code===e);return{file_code:e,title:(null===s||void 0===s?void 0:s.title)||e,category:y||null,status:w}}),s=await c.Er.bulkAddFileCodes(e),l=s.data.results.success.map(e=>e.file_code);r(t.map(e=>l.includes(e.file_code)?(0,a.A)((0,a.A)({},e),{},{alreadyAdded:!0}):e)),p([]),d.Ay.success("Imported ".concat(s.data.results.success.length," videos (").concat(w,")"))}catch(e){d.Ay.error("Failed to import videos")}finally{h(!1)}}},disabled:g,className:"btn-primary",children:g?"Importing...":"Import ".concat(u.length," Videos (").concat(w,")")})]}),(0,x.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:t.map(e=>(0,x.jsxs)("div",{onClick:()=>{return!e.alreadyAdded&&(s=e.file_code,void p(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s]));var s},className:"relative rounded-lg overflow-hidden cursor-pointer transition-all ".concat(e.alreadyAdded?"opacity-50 cursor-not-allowed":u.includes(e.file_code)?"ring-2 ring-primary-500":"hover:ring-2 hover:ring-gray-500"),children:[(0,x.jsx)("div",{className:"aspect-video bg-dark-100",children:(0,x.jsx)("img",{src:"https://abyss.to/thumb/".concat(e.file_code,".jpg"),alt:e.title,className:"w-full h-full object-cover",onError:e=>{e.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIwIiBoZWlnaHQ9IjE4MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMWUxZTFlIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNiIgZmlsbD0iIzY2NiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIFRodW1ibmFpbDwvdGV4dD48L3N2Zz4="}})}),u.includes(e.file_code)&&(0,x.jsx)("div",{className:"absolute inset-0 bg-primary-500/30 flex items-center justify-center",children:(0,x.jsx)("div",{className:"w-8 h-8 bg-primary-500 rounded-full flex items-center justify-center",children:(0,x.jsx)(i.YrT,{className:"w-5 h-5 text-white"})})}),e.alreadyAdded&&(0,x.jsx)("div",{className:"absolute top-2 right-2 bg-green-500 text-white text-xs px-2 py-1 rounded",children:"Added"}),(0,x.jsxs)("div",{className:"p-2",children:[(0,x.jsx)("p",{className:"text-white text-sm truncate",children:e.title||e.file_code}),(0,x.jsx)("p",{className:"text-gray-500 text-xs",children:e.file_code})]})]},e.file_code))}),(0,x.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,x.jsx)("button",{onClick:()=>f(e=>Math.max(1,e-1)),disabled:1===b,className:"btn-secondary",children:"Previous"}),(0,x.jsxs)("span",{className:"px-4 py-2 text-gray-400",children:["Page ",b]}),(0,x.jsx)("button",{onClick:()=>f(e=>e+1),disabled:t.length<50,className:"btn-secondary",children:"Next"})]})]})},h=()=>{const[e,s]=(0,l.useState)("upload"),[t,a]=(0,l.useState)([]);(0,l.useEffect)(()=>{c.G.getCategories().then(e=>{e.data.success&&a(e.data.categories)}).catch(console.error)},[]);const r=[{id:"upload",label:"Upload Videos",icon:i.YoE},{id:"file-code",label:"Add by File Code",icon:i.ayE},{id:"abyss-files",label:"Import from Abyss",icon:i.QuH}];return(0,x.jsxs)(n.A,{title:"Upload Videos",children:[(0,x.jsxs)("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-4 mb-6 flex items-center gap-3",children:[(0,x.jsx)(i.F5$,{className:"w-5 h-5 text-yellow-500 flex-shrink-0"}),(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-yellow-400 text-sm font-medium",children:"All uploads are Private by default"}),(0,x.jsx)("p",{className:"text-yellow-400/60 text-xs",children:"Go to Videos Manager to publish videos after uploading"})]})]}),(0,x.jsxs)("div",{className:"bg-dark-200 rounded-xl border border-dark-100 mb-6",children:[(0,x.jsx)("div",{className:"flex border-b border-dark-100",children:r.map(t=>(0,x.jsxs)("button",{onClick:()=>s(t.id),className:"flex items-center gap-2 px-6 py-4 font-medium transition-colors ".concat(e===t.id?"text-primary-500 border-b-2 border-primary-500":"text-gray-400 hover:text-white"),children:[(0,x.jsx)(t.icon,{className:"w-5 h-5"}),t.label]},t.id))}),(0,x.jsxs)("div",{className:"p-6",children:["upload"===e&&(0,x.jsx)(m,{categories:t}),"file-code"===e&&(0,x.jsx)(p,{categories:t}),"abyss-files"===e&&(0,x.jsx)(g,{categories:t})]})]})]})}}}]);
//# sourceMappingURL=811.71b0f359.chunk.js.map