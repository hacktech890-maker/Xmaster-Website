"use strict";(self.webpackChunkxmaster_frontend=self.webpackChunkxmaster_frontend||[]).push([[483],{8227(e,a,t){t.d(a,{A:()=>c});var s=t(5043),r=t(6305),l=t(6047),i=t(579);const c=e=>{let{placement:a,className:t=""}=e;const[c,n]=(0,s.useState)(null),[d,o]=(0,s.useState)(!0),x=(0,s.useRef)(null),m=(0,s.useRef)(!1);(0,s.useEffect)(()=>{(async()=>{try{const e=(0,l.ZI)(),t=await r.G.getAdByPlacement(a,e);t.data.success&&t.data.ad&&n(t.data.ad)}catch(e){console.error("Failed to fetch ad:",e)}finally{o(!1)}})()},[a]),(0,s.useEffect)(()=>{if(!c||m.current)return;const e=new IntersectionObserver(a=>{a[0].isIntersecting&&(r.G.recordAdImpression(c._id),m.current=!0,e.disconnect())},{threshold:.5});return x.current&&e.observe(x.current),()=>e.disconnect()},[c]);return d||!c?null:(0,i.jsx)("div",{ref:x,className:"ad-banner ".concat(t),onClick:()=>{c&&r.G.recordAdClick(c._id)},children:"script"===c.type||"html"===c.type?(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:c.code}}):"image"===c.type&&c.imageUrl?(0,i.jsx)("a",{href:c.targetUrl,target:"_blank",rel:"noopener noreferrer",children:(0,i.jsx)("img",{src:c.imageUrl,alt:c.name,className:"max-w-full h-auto"})}):(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:c.code}})})}},9483(e,a,t){t.r(a),t.d(a,{default:()=>b});var s=t(9379),r=t(5043),l=t(3216),i=t(5475),c=t(1344),n=t(5772),d=t(3768),o=t(6305),x=t(6047),m=t(579);const g=e=>{let{embedUrl:a,title:t,onReady:s}=e;const l=(0,r.useRef)(null);return(0,r.useEffect)(()=>{const e=l.current;e&&(e.onload=()=>{s&&s()})},[s]),a?(0,m.jsx)("div",{className:"video-container rounded-xl overflow-hidden shadow-2xl",children:(0,m.jsx)("iframe",{ref:l,src:a,title:t||"Video Player",allowFullScreen:!0,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",className:"w-full h-full"})}):(0,m.jsx)("div",{className:"video-container flex items-center justify-center bg-gray-900",children:(0,m.jsx)("p",{className:"text-gray-400",children:"Video not available"})})};var h=t(6630);const u=e=>{let{videoId:a,limit:t=10}=e;const[s,l]=(0,r.useState)([]),[c,d]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{(async()=>{if(a){d(!0);try{const e=await o.G.getRelatedVideos(a,t);e.data.success&&l(e.data.videos)}catch(e){console.error("Failed to fetch related videos:",e)}finally{d(!1)}}})()},[a,t]),c?(0,m.jsx)(h.A,{size:"sm"}):0===s.length?(0,m.jsx)("div",{className:"text-center py-4 text-gray-500",children:"No related videos found"}):(0,m.jsxs)("div",{className:"space-y-3",children:[(0,m.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white text-lg mb-4",children:"Related Videos"}),s.map(e=>(0,m.jsxs)(i.N_,{to:"/watch/".concat(e._id).concat(e.slug?"/".concat(e.slug):""),className:"flex gap-3 group",children:[(0,m.jsxs)("div",{className:"relative w-40 flex-shrink-0",children:[(0,m.jsx)("div",{className:"aspect-video rounded-lg overflow-hidden bg-gray-200 dark:bg-dark-100",children:(0,m.jsx)("img",{src:e.thumbnail,alt:e.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy",onError:e=>{e.target.src="https://via.placeholder.com/160x90?text=Video"}})}),e.duration&&(0,m.jsx)("span",{className:"absolute bottom-1 right-1 px-1.5 py-0.5 bg-black/80 text-white text-xs rounded",children:(0,x.a3)(e.duration)})]}),(0,m.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,m.jsx)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-500 line-clamp-2 transition-colors",children:e.title}),(0,m.jsxs)("div",{className:"mt-1 flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[(0,m.jsxs)("span",{className:"flex items-center gap-1",children:[(0,m.jsx)(n.Vap,{className:"w-3 h-3"}),(0,x.OO)(e.views)]}),(0,m.jsx)("span",{children:"\u2022"}),(0,m.jsx)("span",{children:(0,x.Yq)(e.uploadDate)})]})]})]},e._id))]})};var p=t(8227);const y=e=>{let{videoId:a,onClose:t}=e;const[s,l]=(0,r.useState)(""),[i,c]=(0,r.useState)(""),[x,g]=(0,r.useState)(!1);return(0,m.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,m.jsxs)("div",{className:"bg-white dark:bg-dark-200 rounded-xl max-w-md w-full p-6 animate-fade-in",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Report Video"}),(0,m.jsx)("button",{onClick:t,className:"p-2 hover:bg-gray-100 dark:hover:bg-dark-100 rounded-lg transition-colors",children:(0,m.jsx)(n.yGN,{className:"w-5 h-5"})})]}),(0,m.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),s){g(!0);try{(await o.G.reportVideo(a,{reason:s,description:i})).data.success&&(d.Ay.success("Report submitted successfully"),t())}catch(r){d.Ay.error("Failed to submit report")}finally{g(!1)}}else d.Ay.error("Please select a reason")},className:"space-y-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Reason *"}),(0,m.jsx)("div",{className:"space-y-2",children:[{value:"broken",label:"Video is broken"},{value:"copyright",label:"Copyright violation"},{value:"inappropriate",label:"Inappropriate content"},{value:"spam",label:"Spam or misleading"},{value:"other",label:"Other"}].map(e=>(0,m.jsxs)("label",{className:"flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-colors ".concat(s===e.value?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-dark-100 hover:bg-gray-50 dark:hover:bg-dark-100"),children:[(0,m.jsx)("input",{type:"radio",name:"reason",value:e.value,checked:s===e.value,onChange:e=>l(e.target.value),className:"sr-only"}),(0,m.jsx)("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center ".concat(s===e.value?"border-primary-500 bg-primary-500":"border-gray-300 dark:border-gray-600"),children:s===e.value&&(0,m.jsx)(n.YrT,{className:"w-3 h-3 text-white"})}),(0,m.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:e.label})]},e.value))})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Additional details (optional)"}),(0,m.jsx)("textarea",{value:i,onChange:e=>c(e.target.value),rows:3,className:"input-field resize-none",placeholder:"Provide more details about the issue..."})]}),(0,m.jsxs)("div",{className:"flex gap-3",children:[(0,m.jsx)("button",{type:"button",onClick:t,className:"flex-1 btn-secondary",children:"Cancel"}),(0,m.jsx)("button",{type:"submit",disabled:x,className:"flex-1 btn-primary",children:x?"Submitting...":"Submit Report"})]})]})]})})},b=()=>{const{id:e}=(0,l.g)(),[a,t]=(0,r.useState)(null),[b,f]=(0,r.useState)(!0),[j,v]=(0,r.useState)(null),[k,N]=(0,r.useState)(!1),[w,S]=(0,r.useState)(!1),[A,_]=(0,r.useState)(!1),[C,V]=(0,r.useState)(!1);(0,r.useEffect)(()=>{e&&((async()=>{f(!0),v(null);try{const a=await o.G.getVideo(e);a.data.success?t(a.data.video):v("Video not found")}catch(a){console.error("Failed to fetch video:",a),v("Failed to load video")}finally{f(!1)}})(),_(!1),V(!1))},[e]),(0,r.useEffect)(()=>{if(null!==a&&void 0!==a&&a._id){const e=(0,x.u0)();o.G.recordView(a._id,e).catch(console.error)}},[null===a||void 0===a?void 0:a._id]);return b?(0,m.jsx)(h.A,{fullScreen:!0}):j||!a?(0,m.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-dark-400",children:(0,m.jsxs)("div",{className:"text-center",children:[(0,m.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Video Not Found"}),(0,m.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:j}),(0,m.jsx)(i.N_,{to:"/",className:"btn-primary",children:"Go Home"})]})}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(c.mg,{children:[(0,m.jsxs)("title",{children:[a.title," - Xmaster"]}),(0,m.jsx)("meta",{name:"description",content:a.description||a.title}),(0,m.jsx)("meta",{property:"og:title",content:a.title}),(0,m.jsx)("meta",{property:"og:description",content:a.description||a.title}),(0,m.jsx)("meta",{property:"og:image",content:a.thumbnail}),(0,m.jsx)("meta",{property:"og:type",content:"video.other"})]}),(0,m.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-dark-400",children:(0,m.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,m.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6",children:[(0,m.jsxs)("div",{className:"flex-1",children:[(0,m.jsx)(g,{embedUrl:a.embed_code||"https://abyss.to/e/".concat(a.file_code),title:a.title}),(0,m.jsxs)("div",{className:"mt-4",children:[(0,m.jsx)("h1",{className:"text-xl md:text-2xl font-bold text-gray-900 dark:text-white",children:a.title}),(0,m.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4 mt-4 pb-4 border-b border-gray-200 dark:border-dark-100",children:[(0,m.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[(0,m.jsxs)("span",{className:"flex items-center gap-1",children:[(0,m.jsx)(n.Vap,{className:"w-4 h-4"}),(0,x.OO)(a.views)," views"]}),(0,m.jsxs)("span",{className:"flex items-center gap-1",children:[(0,m.jsx)(n.Ohp,{className:"w-4 h-4"}),(0,x.Yq)(a.uploadDate)]}),a.category&&(0,m.jsx)(i.N_,{to:"/category/".concat(a.category.slug),className:"text-primary-600 hover:text-primary-700",children:a.category.name})]}),(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsxs)("button",{onClick:async()=>{if(!A)try{const a=await o.G.likeVideo(e);a.data.success&&(t(e=>(0,s.A)((0,s.A)({},e),{},{likes:a.data.likes})),_(!0),V(!1),d.Ay.success("Liked!"))}catch(j){d.Ay.error("Failed to like video")}},className:"flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ".concat(A?"bg-primary-600 text-white":"bg-gray-100 dark:bg-dark-200 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-100"),children:[(0,m.jsx)(n.Ydy,{className:"w-4 h-4"}),(0,m.jsx)("span",{children:(0,x.OO)(a.likes||0)})]}),(0,m.jsx)("button",{onClick:async()=>{if(!C)try{const a=await o.G.dislikeVideo(e);a.data.success&&(t(e=>(0,s.A)((0,s.A)({},e),{},{dislikes:a.data.dislikes})),V(!0),_(!1),d.Ay.success("Disliked!"))}catch(j){d.Ay.error("Failed to dislike video")}},className:"flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ".concat(C?"bg-gray-700 text-white":"bg-gray-100 dark:bg-dark-200 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-100"),children:(0,m.jsx)(n.rxb,{className:"w-4 h-4"})}),(0,m.jsxs)("button",{onClick:async()=>{const e=window.location.href;await(0,x.lW)(e)?d.Ay.success("Link copied to clipboard!"):d.Ay.error("Failed to copy link")},className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-100 dark:bg-dark-200 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-100 transition-colors",children:[(0,m.jsx)(n.Pum,{className:"w-4 h-4"}),(0,m.jsx)("span",{className:"hidden sm:inline",children:"Share"})]}),(0,m.jsx)("button",{onClick:()=>S(!0),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-100 dark:bg-dark-200 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-100 transition-colors",children:(0,m.jsx)(n.QsL,{className:"w-4 h-4"})})]})]}),a.description&&(0,m.jsxs)("div",{className:"mt-4",children:[(0,m.jsx)("div",{className:"text-gray-700 dark:text-gray-300 ".concat(k?"":"line-clamp-3"),children:a.description}),a.description.length>200&&(0,m.jsxs)("button",{onClick:()=>N(!k),className:"mt-2 text-sm text-primary-600 hover:text-primary-700 flex items-center gap-1",children:[k?"Show less":"Show more",(0,m.jsx)(n.fK4,{className:"w-4 h-4 transition-transform ".concat(k?"rotate-180":"")})]})]}),a.tags&&a.tags.length>0&&(0,m.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:a.tags.map((e,a)=>(0,m.jsxs)(i.N_,{to:"/tag/".concat(e),className:"px-3 py-1 text-sm bg-gray-100 dark:bg-dark-200 text-gray-700 dark:text-gray-300 rounded-full hover:bg-gray-200 dark:hover:bg-dark-100 transition-colors",children:["#",e]},a))})]}),(0,m.jsx)(p.A,{placement:"watch_below",className:"mt-6"})]}),(0,m.jsxs)("aside",{className:"w-full lg:w-96 flex-shrink-0",children:[(0,m.jsx)(p.A,{placement:"watch_sidebar",className:"mb-6"}),(0,m.jsx)("div",{className:"card p-4",children:(0,m.jsx)(u,{videoId:e,limit:10})}),(0,m.jsx)(p.A,{placement:"watch_related",className:"mt-6"})]})]})})}),w&&(0,m.jsx)(y,{videoId:e,onClose:()=>S(!1)})]})}}}]);
//# sourceMappingURL=483.a173f355.chunk.js.map