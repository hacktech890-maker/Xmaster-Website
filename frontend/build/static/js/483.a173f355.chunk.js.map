{"version":3,"file":"static/js/483.a173f355.chunk.js","mappings":"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","sources":["components/ads/AdBanner.jsx","components/video/VideoPlayer.jsx","components/video/RelatedVideos.jsx","pages/public/WatchPage.jsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport { publicAPI } from '../../services/api';\nimport { getDeviceType } from '../../utils/helpers';\n\nconst AdBanner = ({ placement, className = '' }) => {\n  const [ad, setAd] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const adRef = useRef(null);\n  const impressionRecorded = useRef(false);\n\n  useEffect(() => {\n    const fetchAd = async () => {\n      try {\n        const device = getDeviceType();\n        const response = await publicAPI.getAdByPlacement(placement, device);\n        if (response.data.success && response.data.ad) {\n          setAd(response.data.ad);\n        }\n      } catch (error) {\n        console.error('Failed to fetch ad:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchAd();\n  }, [placement]);\n\n  // Record impression when ad is visible\n  useEffect(() => {\n    if (!ad || impressionRecorded.current) return;\n\n    const observer = new IntersectionObserver(\n      (entries) => {\n        if (entries[0].isIntersecting) {\n          publicAPI.recordAdImpression(ad._id);\n          impressionRecorded.current = true;\n          observer.disconnect();\n        }\n      },\n      { threshold: 0.5 }\n    );\n\n    if (adRef.current) {\n      observer.observe(adRef.current);\n    }\n\n    return () => observer.disconnect();\n  }, [ad]);\n\n  const handleClick = () => {\n    if (ad) {\n      publicAPI.recordAdClick(ad._id);\n    }\n  };\n\n  if (loading || !ad) {\n    return null;\n  }\n\n  return (\n    <div \n      ref={adRef}\n      className={`ad-banner ${className}`}\n      onClick={handleClick}\n    >\n      {ad.type === 'script' || ad.type === 'html' ? (\n        <div dangerouslySetInnerHTML={{ __html: ad.code }} />\n      ) : ad.type === 'image' && ad.imageUrl ? (\n        <a href={ad.targetUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n          <img \n            src={ad.imageUrl} \n            alt={ad.name}\n            className=\"max-w-full h-auto\"\n          />\n        </a>\n      ) : (\n        <div dangerouslySetInnerHTML={{ __html: ad.code }} />\n      )}\n    </div>\n  );\n};\n\nexport default AdBanner;","import React, { useEffect, useRef } from 'react';\n\nconst VideoPlayer = ({ embedUrl, title, onReady }) => {\n  const iframeRef = useRef(null);\n\n  useEffect(() => {\n    // Call onReady when iframe loads\n    const iframe = iframeRef.current;\n    if (iframe) {\n      iframe.onload = () => {\n        onReady && onReady();\n      };\n    }\n  }, [onReady]);\n\n  if (!embedUrl) {\n    return (\n      <div className=\"video-container flex items-center justify-center bg-gray-900\">\n        <p className=\"text-gray-400\">Video not available</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"video-container rounded-xl overflow-hidden shadow-2xl\">\n      <iframe\n        ref={iframeRef}\n        src={embedUrl}\n        title={title || 'Video Player'}\n        allowFullScreen\n        allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n        className=\"w-full h-full\"\n      />\n    </div>\n  );\n};\n\nexport default VideoPlayer;","import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { FiEye } from 'react-icons/fi';\nimport { publicAPI } from '../../services/api';\nimport { formatViews, formatDate, formatDuration } from '../../utils/helpers';\nimport LoadingSpinner from '../common/LoadingSpinner';\n\nconst RelatedVideos = ({ videoId, limit = 10 }) => {\n  const [videos, setVideos] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const fetchRelated = async () => {\n      if (!videoId) return;\n      \n      setLoading(true);\n      try {\n        const response = await publicAPI.getRelatedVideos(videoId, limit);\n        if (response.data.success) {\n          setVideos(response.data.videos);\n        }\n      } catch (error) {\n        console.error('Failed to fetch related videos:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchRelated();\n  }, [videoId, limit]);\n\n  if (loading) {\n    return <LoadingSpinner size=\"sm\" />;\n  }\n\n  if (videos.length === 0) {\n    return (\n      <div className=\"text-center py-4 text-gray-500\">\n        No related videos found\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-3\">\n      <h3 className=\"font-semibold text-gray-900 dark:text-white text-lg mb-4\">\n        Related Videos\n      </h3>\n      \n      {videos.map((video) => (\n        <Link\n          key={video._id}\n          to={`/watch/${video._id}${video.slug ? `/${video.slug}` : ''}`}\n          className=\"flex gap-3 group\"\n        >\n          {/* Thumbnail */}\n          <div className=\"relative w-40 flex-shrink-0\">\n            <div className=\"aspect-video rounded-lg overflow-hidden bg-gray-200 dark:bg-dark-100\">\n              <img\n                src={video.thumbnail}\n                alt={video.title}\n                className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300\"\n                loading=\"lazy\"\n                onError={(e) => {\n                  e.target.src = 'https://via.placeholder.com/160x90?text=Video';\n                }}\n              />\n            </div>\n            {video.duration && (\n              <span className=\"absolute bottom-1 right-1 px-1.5 py-0.5 bg-black/80 text-white text-xs rounded\">\n                {formatDuration(video.duration)}\n              </span>\n            )}\n          </div>\n\n          {/* Info */}\n          <div className=\"flex-1 min-w-0\">\n            <h4 className=\"text-sm font-medium text-gray-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-500 line-clamp-2 transition-colors\">\n              {video.title}\n            </h4>\n            <div className=\"mt-1 flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400\">\n              <span className=\"flex items-center gap-1\">\n                <FiEye className=\"w-3 h-3\" />\n                {formatViews(video.views)}\n              </span>\n              <span>â€¢</span>\n              <span>{formatDate(video.uploadDate)}</span>\n            </div>\n          </div>\n        </Link>\n      ))}\n    </div>\n  );\n};\n\nexport default RelatedVideos;","import React, { useState, useEffect, useCallback } from 'react';\nimport { useParams, Link } from 'react-router-dom';\nimport { Helmet } from 'react-helmet-async';\nimport { \n  FiEye, FiClock, FiThumbsUp, FiThumbsDown, FiShare2, \n  FiFlag, FiChevronDown, FiX, FiCheck \n} from 'react-icons/fi';\nimport toast from 'react-hot-toast';\nimport { publicAPI } from '../../services/api';\nimport { formatViews, formatDate, getSessionId, copyToClipboard } from '../../utils/helpers';\nimport VideoPlayer from '../../components/video/VideoPlayer';\nimport RelatedVideos from '../../components/video/RelatedVideos';\nimport AdBanner from '../../components/ads/AdBanner';\nimport LoadingSpinner from '../../components/common/LoadingSpinner';\n\nconst WatchPage = () => {\n  const { id } = useParams();\n  const [video, setVideo] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [showDescription, setShowDescription] = useState(false);\n  const [showReportModal, setShowReportModal] = useState(false);\n  const [liked, setLiked] = useState(false);\n  const [disliked, setDisliked] = useState(false);\n\n  // Fetch video data\n  useEffect(() => {\n    const fetchVideo = async () => {\n      setLoading(true);\n      setError(null);\n      \n      try {\n        const response = await publicAPI.getVideo(id);\n        if (response.data.success) {\n          setVideo(response.data.video);\n        } else {\n          setError('Video not found');\n        }\n      } catch (err) {\n        console.error('Failed to fetch video:', err);\n        setError('Failed to load video');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    if (id) {\n      fetchVideo();\n      // Reset states\n      setLiked(false);\n      setDisliked(false);\n    }\n  }, [id]);\n\n  // Record view\n  useEffect(() => {\n    if (video?._id) {\n      const sessionId = getSessionId();\n      publicAPI.recordView(video._id, sessionId).catch(console.error);\n    }\n  }, [video?._id]);\n\n  // Handle like\n  const handleLike = async () => {\n    if (liked) return;\n    \n    try {\n      const response = await publicAPI.likeVideo(id);\n      if (response.data.success) {\n        setVideo(prev => ({ ...prev, likes: response.data.likes }));\n        setLiked(true);\n        setDisliked(false);\n        toast.success('Liked!');\n      }\n    } catch (error) {\n      toast.error('Failed to like video');\n    }\n  };\n\n  // Handle dislike\n  const handleDislike = async () => {\n    if (disliked) return;\n    \n    try {\n      const response = await publicAPI.dislikeVideo(id);\n      if (response.data.success) {\n        setVideo(prev => ({ ...prev, dislikes: response.data.dislikes }));\n        setDisliked(true);\n        setLiked(false);\n        toast.success('Disliked!');\n      }\n    } catch (error) {\n      toast.error('Failed to dislike video');\n    }\n  };\n\n  // Handle share\n  const handleShare = async () => {\n    const url = window.location.href;\n    const success = await copyToClipboard(url);\n    if (success) {\n      toast.success('Link copied to clipboard!');\n    } else {\n      toast.error('Failed to copy link');\n    }\n  };\n\n  if (loading) {\n    return <LoadingSpinner fullScreen />;\n  }\n\n  if (error || !video) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-dark-400\">\n        <div className=\"text-center\">\n          <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-4\">\n            Video Not Found\n          </h1>\n          <p className=\"text-gray-600 dark:text-gray-400 mb-6\">{error}</p>\n          <Link to=\"/\" className=\"btn-primary\">\n            Go Home\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <Helmet>\n        <title>{video.title} - Xmaster</title>\n        <meta name=\"description\" content={video.description || video.title} />\n        <meta property=\"og:title\" content={video.title} />\n        <meta property=\"og:description\" content={video.description || video.title} />\n        <meta property=\"og:image\" content={video.thumbnail} />\n        <meta property=\"og:type\" content=\"video.other\" />\n      </Helmet>\n\n      <div className=\"min-h-screen bg-gray-50 dark:bg-dark-400\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n          <div className=\"flex flex-col lg:flex-row gap-6\">\n            {/* Main Content */}\n            <div className=\"flex-1\">\n              {/* Video Player */}\n              <VideoPlayer \n                embedUrl={video.embed_code || `https://abyss.to/e/${video.file_code}`} \n                title={video.title}\n              />\n\n              {/* Video Info */}\n              <div className=\"mt-4\">\n                <h1 className=\"text-xl md:text-2xl font-bold text-gray-900 dark:text-white\">\n                  {video.title}\n                </h1>\n\n                {/* Stats & Actions */}\n                <div className=\"flex flex-wrap items-center justify-between gap-4 mt-4 pb-4 border-b border-gray-200 dark:border-dark-100\">\n                  {/* Stats */}\n                  <div className=\"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400\">\n                    <span className=\"flex items-center gap-1\">\n                      <FiEye className=\"w-4 h-4\" />\n                      {formatViews(video.views)} views\n                    </span>\n                    <span className=\"flex items-center gap-1\">\n                      <FiClock className=\"w-4 h-4\" />\n                      {formatDate(video.uploadDate)}\n                    </span>\n                    {video.category && (\n                      <Link \n                        to={`/category/${video.category.slug}`}\n                        className=\"text-primary-600 hover:text-primary-700\"\n                      >\n                        {video.category.name}\n                      </Link>\n                    )}\n                  </div>\n\n                  {/* Actions */}\n                  <div className=\"flex items-center gap-2\">\n                    <button\n                      onClick={handleLike}\n                      className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${\n                        liked \n                          ? 'bg-primary-600 text-white' \n                          : 'bg-gray-100 dark:bg-dark-200 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-100'\n                      }`}\n                    >\n                      <FiThumbsUp className=\"w-4 h-4\" />\n                      <span>{formatViews(video.likes || 0)}</span>\n                    </button>\n\n                    <button\n                      onClick={handleDislike}\n                      className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${\n                        disliked \n                          ? 'bg-gray-700 text-white' \n                          : 'bg-gray-100 dark:bg-dark-200 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-100'\n                      }`}\n                    >\n                      <FiThumbsDown className=\"w-4 h-4\" />\n                    </button>\n\n                    <button\n                      onClick={handleShare}\n                      className=\"flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-100 dark:bg-dark-200 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-100 transition-colors\"\n                    >\n                      <FiShare2 className=\"w-4 h-4\" />\n                      <span className=\"hidden sm:inline\">Share</span>\n                    </button>\n\n                    <button\n                      onClick={() => setShowReportModal(true)}\n                      className=\"flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-100 dark:bg-dark-200 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-100 transition-colors\"\n                    >\n                      <FiFlag className=\"w-4 h-4\" />\n                    </button>\n                  </div>\n                </div>\n\n                {/* Description */}\n                {video.description && (\n                  <div className=\"mt-4\">\n                    <div className={`text-gray-700 dark:text-gray-300 ${!showDescription ? 'line-clamp-3' : ''}`}>\n                      {video.description}\n                    </div>\n                    {video.description.length > 200 && (\n                      <button\n                        onClick={() => setShowDescription(!showDescription)}\n                        className=\"mt-2 text-sm text-primary-600 hover:text-primary-700 flex items-center gap-1\"\n                      >\n                        {showDescription ? 'Show less' : 'Show more'}\n                        <FiChevronDown className={`w-4 h-4 transition-transform ${showDescription ? 'rotate-180' : ''}`} />\n                      </button>\n                    )}\n                  </div>\n                )}\n\n                {/* Tags */}\n                {video.tags && video.tags.length > 0 && (\n                  <div className=\"mt-4 flex flex-wrap gap-2\">\n                    {video.tags.map((tag, index) => (\n                      <Link\n                        key={index}\n                        to={`/tag/${tag}`}\n                        className=\"px-3 py-1 text-sm bg-gray-100 dark:bg-dark-200 text-gray-700 dark:text-gray-300 rounded-full hover:bg-gray-200 dark:hover:bg-dark-100 transition-colors\"\n                      >\n                        #{tag}\n                      </Link>\n                    ))}\n                  </div>\n                )}\n              </div>\n\n              {/* Below Player Ad */}\n              <AdBanner placement=\"watch_below\" className=\"mt-6\" />\n            </div>\n\n            {/* Sidebar */}\n            <aside className=\"w-full lg:w-96 flex-shrink-0\">\n              {/* Sidebar Ad */}\n              <AdBanner placement=\"watch_sidebar\" className=\"mb-6\" />\n\n              {/* Related Videos */}\n              <div className=\"card p-4\">\n                <RelatedVideos videoId={id} limit={10} />\n              </div>\n\n              {/* Another Ad */}\n              <AdBanner placement=\"watch_related\" className=\"mt-6\" />\n            </aside>\n          </div>\n        </div>\n      </div>\n\n      {/* Report Modal */}\n      {showReportModal && (\n        <ReportModal \n          videoId={id} \n          onClose={() => setShowReportModal(false)} \n        />\n      )}\n    </>\n  );\n};\n\n// Report Modal Component\nconst ReportModal = ({ videoId, onClose }) => {\n  const [reason, setReason] = useState('');\n  const [description, setDescription] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  const reasons = [\n    { value: 'broken', label: 'Video is broken' },\n    { value: 'copyright', label: 'Copyright violation' },\n    { value: 'inappropriate', label: 'Inappropriate content' },\n    { value: 'spam', label: 'Spam or misleading' },\n    { value: 'other', label: 'Other' },\n  ];\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!reason) {\n      toast.error('Please select a reason');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      const response = await publicAPI.reportVideo(videoId, { reason, description });\n      if (response.data.success) {\n        toast.success('Report submitted successfully');\n        onClose();\n      }\n    } catch (error) {\n      toast.error('Failed to submit report');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white dark:bg-dark-200 rounded-xl max-w-md w-full p-6 animate-fade-in\">\n        <div className=\"flex items-center justify-between mb-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n            Report Video\n          </h3>\n          <button\n            onClick={onClose}\n            className=\"p-2 hover:bg-gray-100 dark:hover:bg-dark-100 rounded-lg transition-colors\"\n          >\n            <FiX className=\"w-5 h-5\" />\n          </button>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              Reason *\n            </label>\n            <div className=\"space-y-2\">\n              {reasons.map((r) => (\n                <label\n                  key={r.value}\n                  className={`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-colors ${\n                    reason === r.value\n                      ? 'border-primary-500 bg-primary-50 dark:bg-primary-900/20'\n                      : 'border-gray-200 dark:border-dark-100 hover:bg-gray-50 dark:hover:bg-dark-100'\n                  }`}\n                >\n                  <input\n                    type=\"radio\"\n                    name=\"reason\"\n                    value={r.value}\n                    checked={reason === r.value}\n                    onChange={(e) => setReason(e.target.value)}\n                    className=\"sr-only\"\n                  />\n                  <div className={`w-5 h-5 rounded-full border-2 flex items-center justify-center ${\n                    reason === r.value ? 'border-primary-500 bg-primary-500' : 'border-gray-300 dark:border-gray-600'\n                  }`}>\n                    {reason === r.value && <FiCheck className=\"w-3 h-3 text-white\" />}\n                  </div>\n                  <span className=\"text-gray-700 dark:text-gray-300\">{r.label}</span>\n                </label>\n              ))}\n            </div>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              Additional details (optional)\n            </label>\n            <textarea\n              value={description}\n              onChange={(e) => setDescription(e.target.value)}\n              rows={3}\n              className=\"input-field resize-none\"\n              placeholder=\"Provide more details about the issue...\"\n            />\n          </div>\n\n          <div className=\"flex gap-3\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"flex-1 btn-secondary\"\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"flex-1 btn-primary\"\n            >\n              {loading ? 'Submitting...' : 'Submit Report'}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default WatchPage;"],"names":["_ref","placement","className","ad","setAd","useState","loading","setLoading","adRef","useRef","impressionRecorded","useEffect","async","device","getDeviceType","response","publicAPI","getAdByPlacement","data","success","error","console","fetchAd","current","observer","IntersectionObserver","entries","isIntersecting","recordAdImpression","_id","disconnect","threshold","observe","_jsx","ref","concat","onClick","handleClick","recordAdClick","children","type","dangerouslySetInnerHTML","__html","code","imageUrl","href","targetUrl","target","rel","src","alt","name","embedUrl","title","onReady","iframeRef","iframe","onload","allowFullScreen","allow","videoId","limit","videos","setVideos","getRelatedVideos","fetchRelated","LoadingSpinner","size","length","_jsxs","map","video","Link","to","slug","thumbnail","onError","e","duration","formatDuration","FiEye","formatViews","views","formatDate","uploadDate","ReportModal","onClose","reason","setReason","description","setDescription","FiX","onSubmit","preventDefault","reportVideo","toast","value","label","r","checked","onChange","FiCheck","rows","placeholder","disabled","WatchPage","id","useParams","setVideo","setError","showDescription","setShowDescription","showReportModal","setShowReportModal","liked","setLiked","disliked","setDisliked","getVideo","err","fetchVideo","sessionId","getSessionId","recordView","catch","fullScreen","_Fragment","Helmet","content","property","VideoPlayer","embed_code","file_code","FiClock","category","likeVideo","prev","_objectSpread","likes","FiThumbsUp","dislikeVideo","dislikes","FiThumbsDown","url","window","location","copyToClipboard","FiShare2","FiFlag","FiChevronDown","tags","tag","index","AdBanner","RelatedVideos"],"sourceRoot":""}