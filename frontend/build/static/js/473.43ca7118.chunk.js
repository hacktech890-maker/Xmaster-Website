"use strict";(self.webpackChunkxmaster_frontend=self.webpackChunkxmaster_frontend||[]).push([[473],{5992(e,t,a){a.d(t,{A:()=>o});var l=a(5043),s=a(3216),r=a(5475),d=a(5772),i=a(5187),n=a(579);const c=()=>{const[e,t]=(0,l.useState)(!1),a=(0,s.zy)(),c=(0,s.Zp)(),{logout:o}=(0,i.As)(),x=[{name:"Dashboard",path:"/admin/dashboard",icon:d.V5Y},{name:"Videos",path:"/admin/videos",icon:d.pVQ},{name:"Upload",path:"/admin/upload",icon:d.B88},{name:"Categories",path:"/admin/categories",icon:d.QPV},{name:"Comments",path:"/admin/comments",icon:d.mEP},{name:"Duplicates",path:"/admin/duplicates",icon:d.nxz},{name:"Ads",path:"/admin/ads",icon:d.z8N},{name:"Reports",path:"/admin/reports",icon:d.QsL}],m=()=>{o(),c("/xmaster-admin")},h=()=>(0,n.jsxs)("div",{className:"flex flex-col h-full",children:[(0,n.jsx)("div",{className:"p-4 sm:p-6 border-b border-gray-200 dark:border-dark-100",children:(0,n.jsxs)(r.N_,{to:"/admin/dashboard",className:"flex items-center gap-3",children:[(0,n.jsx)("img",{src:"/logo.jpg",alt:"Xmaster",className:"w-10 h-10 rounded-lg object-cover"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Xmaster"}),(0,n.jsx)("p",{className:"text-xs text-gray-500",children:"Admin Panel"})]})]})}),(0,n.jsx)("nav",{className:"flex-1 p-4 space-y-1 overflow-y-auto",children:x.map(e=>{return(0,n.jsxs)(r.N_,{to:e.path,onClick:()=>t(!1),className:"flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-all ".concat((l=e.path,a.pathname===l?"bg-primary-600 text-white shadow-lg shadow-primary-600/30":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-dark-100")),children:[(0,n.jsx)(e.icon,{className:"w-5 h-5"}),(0,n.jsx)("span",{children:e.name})]},e.path);var l})}),(0,n.jsxs)("div",{className:"p-4 border-t border-gray-200 dark:border-dark-100 space-y-1",children:[(0,n.jsxs)(r.N_,{to:"/",className:"flex items-center gap-3 px-4 py-3 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-dark-100 rounded-lg transition-all",children:[(0,n.jsx)(d.VSk,{className:"w-5 h-5"}),(0,n.jsx)("span",{children:"View Site"})]}),(0,n.jsxs)("button",{onClick:m,className:"flex items-center gap-3 px-4 py-3 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all w-full",children:[(0,n.jsx)(d.QeK,{className:"w-5 h-5"}),(0,n.jsx)("span",{children:"Logout"})]})]})]});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:()=>t(!e),className:"fixed top-4 left-4 z-50 md:hidden p-2 bg-white dark:bg-dark-200 border border-gray-200 dark:border-dark-100 rounded-lg shadow-lg",children:e?(0,n.jsx)(d.yGN,{className:"w-5 h-5"}):(0,n.jsx)(d.ND1,{className:"w-5 h-5"})}),e&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/50 z-30 md:hidden",onClick:()=>t(!1)}),(0,n.jsx)("aside",{className:"fixed top-0 left-0 h-full w-64 bg-white dark:bg-dark-300 border-r border-gray-200 dark:border-dark-100 z-40 transform transition-transform duration-300 ".concat(e?"translate-x-0":"-translate-x-full"," md:translate-x-0"),children:(0,n.jsx)(h,{})})]})},o=e=>{let{children:t,title:a=""}=e;return(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-dark-400",children:(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)(c,{}),(0,n.jsxs)("div",{className:"flex-1 ml-0 md:ml-64",children:[a&&(0,n.jsx)("div",{className:"bg-white dark:bg-dark-300 border-b border-gray-100 dark:border-dark-100 px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:(0,n.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-white",children:a})}),(0,n.jsx)("div",{className:"p-4 sm:p-6 lg:p-8",children:t})]})]})})}},1473(e,t,a){a.r(t),a.d(t,{default:()=>n});var l=a(9379),s=a(5043),r=a(6305),d=a(5992),i=a(579);const n=()=>{const[e,t]=(0,s.useState)([]),[a,n]=(0,s.useState)({total:0,byTitle:0,byDuration:0,byFile:0}),[c,o]=(0,s.useState)({page:1,pages:1,total:0}),[x,m]=(0,s.useState)("all"),[h,p]=(0,s.useState)(!1),[u,g]=(0,s.useState)(!1),[b,f]=(0,s.useState)([]),[y,j]=(0,s.useState)({}),[v,N]=(0,s.useState)(null),k=(0,s.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x;p(!0);try{const l=await r.Er.getDuplicates({filter:a,page:e,limit:50});l.data.success&&(t(l.data.duplicates),n(l.data.stats),o(l.data.pagination))}catch(l){console.error("Failed to fetch duplicates:",l)}finally{p(!1)}},[x]);(0,s.useEffect)(()=>{k(1,x)},[x,k]);const w=async(e,a,s)=>{if("delete"!==e||window.confirm('Delete "'.concat(s,'"? This cannot be undone.'))){j(t=>(0,l.A)((0,l.A)({},t),{},{[a]:e}));try{var d,i;let s;"delete"===e?s=await r.Er.deleteDuplicate(a):"keep"===e?s=await r.Er.keepDuplicate(a):"public"===e&&(s=await r.Er.makePublicDuplicate(a)),null!==(d=s)&&void 0!==d&&null!==(i=d.data)&&void 0!==i&&i.success&&(t(e=>e.filter(e=>e._id!==a)),n(e=>(0,l.A)((0,l.A)({},e),{},{total:e.total-1})))}catch(c){console.error("".concat(e," failed:"),c)}finally{j(e=>(0,l.A)((0,l.A)({},e),{},{[a]:null}))}}},_=e=>e?e.thumbnail&&e.thumbnail.startsWith("http")?e.thumbnail:e.file_code?"https://abyss.to/splash/".concat(e.file_code,".jpg"):"":"",D=e=>{if(!e)return"N/A";const t=Math.floor(e/3600),a=Math.floor(e%3600/60),l=e%60;return t>0?"".concat(t,":").concat(String(a).padStart(2,"0"),":").concat(String(l).padStart(2,"0")):"".concat(a,":").concat(String(l).padStart(2,"0"))},C={title:"bg-red-500/20 text-red-400 border-red-500/30",duration:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",file:"bg-purple-500/20 text-purple-400 border-purple-500/30",thumbnail:"bg-blue-500/20 text-blue-400 border-blue-500/30"},S={title:"Title Match",duration:"Duration Match",file:"File Match",thumbnail:"Thumbnail Match"};return(0,i.jsxs)(d.A,{title:"Duplicate Manager",children:[(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[(0,i.jsx)("p",{className:"text-gray-400 text-sm",children:"Manage duplicate videos detected during uploads"}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("button",{onClick:async()=>{if(!u&&window.confirm("Scan all videos for duplicates? This may take a while.")){g(!0),N(null);try{const e=await r.Er.scanDuplicates();e.data.success&&(N(e.data),k(1,x))}catch(e){console.error("Scan failed:",e)}finally{g(!1)}}},disabled:u,className:"px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 flex items-center gap-2",children:u?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"})," Scanning..."]}):(0,i.jsx)(i.Fragment,{children:"\ud83d\udd0d Scan for Duplicates"})}),a.total>0&&(0,i.jsx)("button",{onClick:async()=>{if(window.confirm("Clear all duplicate flags? (Videos won't be deleted)")){p(!0);try{await r.Er.clearAllDuplicates(),k(1,x)}catch(e){console.error("Clear failed:",e)}finally{p(!1)}}},className:"px-4 py-2.5 bg-dark-100 hover:bg-dark-300 text-gray-300 rounded-lg font-medium transition-colors",children:"\ud83e\uddf9 Clear All Flags"})]})]}),v&&(0,i.jsxs)("div",{className:"mb-6 p-4 bg-blue-500/10 border border-blue-500/20 rounded-xl text-blue-400 text-sm",children:["Found ",v.duplicatesFound," duplicates out of ",v.totalScanned," videos scanned."]}),(0,i.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mb-6",children:[{key:"all",label:"Total",value:a.total,color:"border-gray-500"},{key:"title",label:"Title Match",value:a.byTitle,color:"border-red-500"},{key:"duration",label:"Duration Match",value:a.byDuration,color:"border-yellow-500"},{key:"file",label:"File Match",value:a.byFile,color:"border-purple-500"}].map(e=>(0,i.jsxs)("button",{onClick:()=>m(e.key),className:"p-4 rounded-xl border-2 transition-all text-left ".concat(x===e.key?"".concat(e.color," bg-dark-100"):"border-dark-100 bg-dark-200 hover:bg-dark-100"),children:[(0,i.jsx)("p",{className:"text-2xl font-bold text-white",children:e.value}),(0,i.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:e.label})]},e.key))}),b.length>0&&(0,i.jsxs)("div",{className:"mb-4 flex items-center gap-4 p-4 bg-dark-100 rounded-xl",children:[(0,i.jsxs)("span",{className:"text-gray-400",children:[b.length," selected"]}),(0,i.jsx)("button",{onClick:async()=>{if(0!==b.length&&window.confirm("Delete ".concat(b.length," duplicates?"))){p(!0);try{await r.Er.bulkDeleteDuplicates(b),f([]),k(c.page,x)}catch(e){console.error("Bulk delete failed:",e)}finally{p(!1)}}},className:"px-4 py-2 bg-red-500/10 text-red-500 hover:bg-red-500/20 rounded-lg transition-colors text-sm",children:"\ud83d\uddd1\ufe0f Delete Selected"}),(0,i.jsx)("button",{onClick:()=>f([]),className:"px-4 py-2 bg-dark-200 text-gray-400 hover:text-white rounded-lg transition-colors text-sm",children:"Cancel"})]}),(0,i.jsx)("div",{className:"space-y-4",children:h?(0,i.jsxs)("div",{className:"text-center py-16",children:[(0,i.jsx)("div",{className:"w-8 h-8 border-3 border-primary-500/30 border-t-primary-500 rounded-full animate-spin mx-auto mb-4"}),(0,i.jsx)("p",{className:"text-gray-400",children:"Loading duplicates..."})]}):0===e.length?(0,i.jsxs)("div",{className:"text-center py-16 bg-dark-200 rounded-xl",children:[(0,i.jsx)("div",{className:"text-5xl mb-4",children:"\u2728"}),(0,i.jsx)("h3",{className:"text-white text-lg font-semibold mb-2",children:"No Duplicates Found"}),(0,i.jsx)("p",{className:"text-gray-400 text-sm",children:"all"!==x?"No ".concat(x,' match duplicates. Try "Total" filter.'):"Your library is clean!"})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex items-center gap-3 px-2",children:[(0,i.jsx)("input",{type:"checkbox",checked:b.length===e.length&&e.length>0,onChange:()=>{b.length===e.length?f([]):f(e.map(e=>e._id))},className:"rounded"}),(0,i.jsxs)("span",{className:"text-gray-400 text-sm",children:["Select All (",e.length,")"]})]}),e.map(e=>{var a;const s=e.duplicateOf,d=s&&"object"===typeof s;return(0,i.jsxs)("div",{className:"bg-dark-200 rounded-xl border overflow-hidden transition-colors ".concat(b.includes(e._id)?"border-primary-500":"border-dark-100"),children:[(0,i.jsx)("div",{className:"flex items-center justify-between p-4 bg-dark-300 border-b border-dark-100",children:(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("input",{type:"checkbox",checked:b.includes(e._id),onChange:()=>{return t=e._id,void f(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"rounded"}),(0,i.jsx)("span",{className:"text-white font-medium text-sm",children:"Duplicate Detected"}),(0,i.jsx)("div",{className:"flex gap-2",children:null===(a=e.duplicateReasons)||void 0===a?void 0:a.map(e=>(0,i.jsx)("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium border ".concat(C[e]||"bg-gray-500/20 text-gray-400"),children:S[e]||e},e))})]})}),(0,i.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 divide-y lg:divide-y-0 lg:divide-x divide-dark-100",children:[(0,i.jsxs)("div",{className:"p-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,i.jsx)("span",{className:"px-2.5 py-1 bg-red-500/20 text-red-400 rounded-full text-xs font-semibold",children:"\ud83d\udd34 DUPLICATE"}),(0,i.jsx)("span",{className:"px-2.5 py-1 bg-gray-500/20 text-gray-400 rounded-full text-xs",children:"\ud83d\udd12 Private"})]}),(0,i.jsxs)("div",{className:"flex gap-3",children:[(0,i.jsx)("div",{className:"w-40 h-24 rounded-lg overflow-hidden bg-dark-100 flex-shrink-0",children:_(e)?(0,i.jsx)("img",{src:_(e),alt:e.title,className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none"}}):(0,i.jsx)("div",{className:"w-full h-full flex items-center justify-center text-2xl",children:"\ud83c\udfac"})}),(0,i.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,i.jsx)("h4",{className:"text-white font-medium text-sm truncate",children:e.title}),(0,i.jsxs)("div",{className:"mt-2 space-y-1 text-xs text-gray-400",children:[(0,i.jsxs)("p",{children:["\ud83d\udcc1 ",e.file_code]}),(0,i.jsxs)("p",{children:["\u23f1\ufe0f ",e.duration||D(e.duration_seconds)]}),(0,i.jsxs)("p",{children:["\ud83d\udc41\ufe0f ",e.views||0," views"]}),(0,i.jsxs)("p",{children:["\ud83d\udcc5 ",new Date(e.createdAt).toLocaleDateString()]})]})]})]}),(0,i.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,i.jsx)("button",{onClick:()=>w("keep",e._id),disabled:!!y[e._id],className:"flex-1 px-3 py-2 bg-green-600/20 text-green-400 hover:bg-green-600/30 rounded-lg text-xs font-medium transition-colors disabled:opacity-50",children:"keep"===y[e._id]?"...":"\u2705 Keep as Unique"}),(0,i.jsx)("button",{onClick:()=>w("public",e._id),disabled:!!y[e._id],className:"flex-1 px-3 py-2 bg-blue-600/20 text-blue-400 hover:bg-blue-600/30 rounded-lg text-xs font-medium transition-colors disabled:opacity-50",children:"public"===y[e._id]?"...":"\ud83c\udf10 Make Public"}),(0,i.jsx)("button",{onClick:()=>w("delete",e._id,e.title),disabled:!!y[e._id],className:"flex-1 px-3 py-2 bg-red-600/20 text-red-400 hover:bg-red-600/30 rounded-lg text-xs font-medium transition-colors disabled:opacity-50",children:"delete"===y[e._id]?"...":"\ud83d\uddd1\ufe0f Delete"})]})]}),(0,i.jsxs)("div",{className:"p-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,i.jsx)("span",{className:"px-2.5 py-1 bg-green-500/20 text-green-400 rounded-full text-xs font-semibold",children:"\ud83d\udfe2 ORIGINAL"}),d&&(0,i.jsx)("span",{className:"px-2.5 py-1 rounded-full text-xs ".concat("public"===s.status?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"),children:"public"===s.status?"\ud83c\udf10 Public":"\ud83d\udd12 "+(s.status||"Unknown")})]}),d?(0,i.jsxs)("div",{className:"flex gap-3",children:[(0,i.jsx)("div",{className:"w-40 h-24 rounded-lg overflow-hidden bg-dark-100 flex-shrink-0",children:_(s)?(0,i.jsx)("img",{src:_(s),alt:s.title,className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none"}}):(0,i.jsx)("div",{className:"w-full h-full flex items-center justify-center text-2xl",children:"\ud83c\udfac"})}),(0,i.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,i.jsx)("h4",{className:"text-white font-medium text-sm truncate",children:s.title}),(0,i.jsxs)("div",{className:"mt-2 space-y-1 text-xs text-gray-400",children:[(0,i.jsxs)("p",{children:["\ud83d\udcc1 ",s.file_code]}),(0,i.jsxs)("p",{children:["\u23f1\ufe0f ",s.duration||"N/A"]}),(0,i.jsxs)("p",{children:["\ud83d\udc41\ufe0f ",s.views||0," views"]})]})]})]}):(0,i.jsx)("div",{className:"flex items-center justify-center h-24 bg-dark-100 rounded-lg",children:(0,i.jsx)("p",{className:"text-gray-500 text-sm",children:"Original video data not available"})}),d&&(0,i.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,i.jsx)("button",{onClick:()=>w("delete",s._id,s.title),disabled:!!y[s._id],className:"flex-1 px-3 py-2 bg-red-600/20 text-red-400 hover:bg-red-600/30 rounded-lg text-xs font-medium transition-colors disabled:opacity-50",children:"delete"===y[s._id]?"...":"\ud83d\uddd1\ufe0f Delete Original"}),(0,i.jsx)("a",{href:"/watch/".concat(s._id),target:"_blank",rel:"noopener noreferrer",className:"flex-1 px-3 py-2 bg-dark-100 text-gray-400 hover:text-white hover:bg-dark-300 rounded-lg text-xs font-medium transition-colors text-center",children:"\ud83d\udc41\ufe0f View Original"})]})]})]}),d&&(0,i.jsx)("div",{className:"px-4 py-3 bg-dark-300 border-t border-dark-100 flex justify-center",children:(0,i.jsx)("button",{onClick:async()=>{if(window.confirm("Delete BOTH videos? This cannot be undone.")){j(t=>(0,l.A)((0,l.A)({},t),{},{[e._id]:"delete",[s._id]:"delete"}));try{await r.Er.bulkDeleteDuplicates([e._id,s._id]),t(t=>t.filter(t=>t._id!==e._id)),n(e=>(0,l.A)((0,l.A)({},e),{},{total:e.total-1}))}catch(a){console.error("Delete both failed:",a)}finally{j(t=>(0,l.A)((0,l.A)({},t),{},{[e._id]:null,[s._id]:null}))}}},className:"px-4 py-2 bg-red-600/10 text-red-400 hover:bg-red-600/20 rounded-lg text-xs font-medium transition-colors",children:"\ud83d\uddd1\ufe0f Delete Both Videos"})})]},e._id)}),c.pages>1&&(0,i.jsxs)("div",{className:"flex items-center justify-center gap-4 pt-4",children:[(0,i.jsx)("button",{disabled:c.page<=1,onClick:()=>k(c.page-1),className:"px-4 py-2 bg-dark-100 text-gray-400 hover:text-white rounded-lg disabled:opacity-50 transition-colors",children:"\u2190 Prev"}),(0,i.jsxs)("span",{className:"text-gray-400 text-sm",children:["Page ",c.page," of ",c.pages]}),(0,i.jsx)("button",{disabled:c.page>=c.pages,onClick:()=>k(c.page+1),className:"px-4 py-2 bg-dark-100 text-gray-400 hover:text-white rounded-lg disabled:opacity-50 transition-colors",children:"Next \u2192"})]})]})})]})}}}]);
//# sourceMappingURL=473.43ca7118.chunk.js.map